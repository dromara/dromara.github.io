<!doctype html><html><head><title>版本发行日志 · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="zh"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/projects/><span>项目</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/guides/><span>指南</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/blog/><span>博客</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/activities/><span>活动</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/community/><span>社区</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/projects/sofa-jraft/release-log/><span>English</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/projects/>项目</a>
<a class=navbar-item href=/guides/>指南</a>
<a class=navbar-item href=/blog/>博客</a>
<a class=navbar-item href=/activities/>活动</a>
<a class=navbar-item href=/community/>社区</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/en/projects/sofa-jraft/release-log/>En</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>版本发行日志</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/zh/projects/sofa-jraft/release-log/index.md>编辑</a></div><div class=meta>更新时间: 2021-01-24</div></div><article class=typo><hr><h2 id=1-3-2>1.3.2</h2><p>2020-06-19</p><ul><li>Bug Fixes<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/425>移除对 bolt address parser 的扩展，避免 check connection 返回结果不符合预期</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/447>SPI 组件 JRaftServiceLoader 改为延迟加载策略规避多余对象的创建</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/462>几个 corner case 修复，比如 replicate logs 如果比 appliedIndex（follower）更小，那么可以认为是成功的</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/463>关闭 Recyclers 时的 IndexOutOfBoundsException 问题修复</a></li></ul></li><li>Features<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/433>抽象出网络通信层，增加 GRPC 实现并支持 Replication Pipeline，用户亦可自行对通信层进行其他实现的扩展</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/422>RheaKV 增加 reverseScan API</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/462>提供 Replicator 与 RPC 的线程池隔离，避免相互影响</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/465>read-index 线性一致读请求提供请求超时（timeout）配置</a></li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li><li>致谢（排名不分先后）<ul><li>@shibd @SteNicholas @killme2008 @zongtanghu</li></ul></li></ul><hr><h2 id=1-3-1>1.3.1</h2><p>2020-04-17</p><ul><li>Bug Fixes<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/413>修复 bolt rpc callback 默认的任务饱和丢弃策略，改为抛出异常</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/385>修复 learner 启动晚于 leader 选举成功时无法复制日志的 bug</a></li></ul></li><li>Features<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/414>multi raft group 之间共享 timer 和 scheduler 等较重的线程资源，优化 multi group 场景中的多余资源占用</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/402>提供 RPC adapter，用户可基于 SPI 扩展不同的 RPC 实现</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/399>正式提供稳定的 RocksDBSegmentLogStorage，适合 value 较大的数据存储</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/161>sofa-bolt 升级到 1.6.1，支持 SSL 以及具有更好的小数据包传输能力</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/377>引入一个新的数据结构 segment list 来解决 LogManager 中过多的 log memory copy</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/403>采纳 nacos 的建议，对 raft Task 增加 join API</a></li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li><li>致谢（排名不分先后）<ul><li>@jovany-wang @SteNicholas @zongtanghu @OpenOpened</li></ul></li></ul><hr><h2 id=1-3-0>1.3.0</h2><p>2019-11-29</p><ul><li>Bug Fixes<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/255>删除数据并重启且期间没有新的 task 提交的情况下 prev log index 紊乱的修复</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/361>修复一些选举和线性一致读相关的 corner case</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/355>Recyclers 多个线程 recycle 资源时的 NPE 修复</a></li></ul></li><li>Features<ul><li><a href=https://github.com/sofastack/sofa-jraft/pull/312>新增 Read-only member(learner) 角色，支持 learner 节点上的线性一致读</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/334>实现优先级选举</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/358>在 multi raft group 的场景中，随机打散每个 group 的第一次 snapshot timeout 时间，避免一个进程内多个 group 同时 snapshot</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/302>RheaKV 新增 containsKey API</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/287>RheaKV 实现 snapshot checksum 以及异步 snapshot</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/256>新增 replicator 的 state 监听器： ReplicatorStateListener</a></li><li><a href=https://github.com/sofastack/sofa-jraft/pull/258>RepeatedTimer 的默认实现替换为 HashedWheelTimer</a></li><li><a href=https://github.com/sofastack/sofa-jraft/issues/311>修复 windows 上定时器 CPU 消耗偏高的问题</a></li><li>kill -s SIGUSR2 pid 中增加打印 rocksdb stats 和所有 ThreadPool 指标统计信息</li><li>升级 rocksdb 版本到 5.18.3</li><li><a href=https://github.com/sofastack/sofa-jraft/pull/156>新增实验性质的 RocksDBSegmentLogStorage，适合 value 较大的数据存储</a></li><li>Counter 例子改进，演示 ReadIndex 线性一致读</li><li><a href=https://github.com/sofastack/sofa-jraft/pull/293>当优化 checksum 中多余的 mem copy</a></li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li><li>致谢（排名不分先后）<ul><li>@zongtanghu @devYun @masaimu @SteNicholas @yetingsky</li></ul></li></ul><hr><h2 id=1-2-6>1.2.6</h2><p>2019-08-15</p><ul><li>Bug Fixes<ul><li><a href=https://github.com/alipay/sofa-jraft/pull/121>修复 ReadIndex 并发情况下可能出现的读超时</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/96>保存 raft meta 失败后终止状态机</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/104>修复 windows 环境中无法原子 move 文件的问题</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/137>当 RheaKV apply 失败时终止状态机避免出现数据不一致情况</a></li></ul></li><li>Features<ul><li><a href=https://github.com/alipay/sofa-jraft/pull/123>增加 LogEntry checksum validation</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/170>优化 log replication 线程模型减少锁竞争</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/42>优化 RheaKV multi group snapshot</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/176>对于 multi-raft-group 场景，提供 manual rebalance API 在无 PD 模式手动平衡各节点 leader 数量</a></li><li>CliService 提供获取存活 follower 节点的 API</li><li>引入 SPI 扩展机制，LogStorage、SnapshotStorage、RaftMetaStorage、LogEntryCodec 均可基于 SPI 扩展</li><li><a href=https://github.com/alipay/sofa-jraft/pull/208>Linux 平台 SIGUSR2 信号输出节点状态以及 metric 信息</a></li><li>RheaKV 增加 CompareAndPut 原子更新 API</li><li><a href=https://github.com/alipay/sofa-jraft/pull/161>新增 pooled buf allocator 解决 log replication 时大量分配 byte[] 频繁触发 fullgc</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/159>默认关闭 RheaKV rocksdb 的 fsync 和 WAL，依靠 raft log 和 snapshot 确保数据一致性</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/144>当 raft node 过载时拒绝新的请求</a></li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li><li>致谢（排名不分先后）<ul><li>@SteNicholas @zongtanghu</li></ul></li></ul><hr><h2 id=1-2-5>1.2.5</h2><p>2019-04-01</p><ul><li>Bug Fixes<ul><li>修复 jmh 与 unit test 代码冲突问题</li><li>修复 snapshot 过大引起的安装失败 bug，会影响新增节点的加入</li></ul></li><li>Features<ul><li>LogManagerImpl 中耗费 cpu 部分的代码优化</li><li>修正一些单词拼写错误</li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li></ul><p><strong>此版本强烈推荐升级</strong></p><hr><h2 id=1-2-4>1.2.4</h2><p>2019-03-20</p><ul><li>Bug Fixes<ul><li><a href=https://github.com/alipay/sofa-jraft/pull/34>修复一种情况下 lease read 的 stale read</a></li><li><a href=https://github.com/alipay/sofa-jraft/issues/24>部分 timestamp 修改为 monotonic time</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/19>修复一种情况下 replicator 被 block 住的问题</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/51>解决 windows 平台下某些单测无法创建目录</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/22>解决 windows 平台下某些 rocksdb options 设置不当导致进程 crash</a></li></ul></li><li>Features<ul><li><a href=https://github.com/alipay/sofa-jraft/issues/20>开放 RocksDB options 的设置给用户层</a></li><li><a href=https://github.com/alipay/sofa-jraft/issues/15>Pre-vote 优化，启用 lease 机制来规避网络分区+集群长时间无写入的情况下，游离节点回归后打断当前 term，提升系统可用性</a></li><li><a href=https://github.com/alipay/sofa-jraft/issues/10>升级 bolt 到 1.5.3</a></li><li><a href=https://github.com/alipay/sofa-jraft/pull/3>BallotBox 中的 ReadWriteLock 优化为 StampedLock 并对 lastCommittedIndex 提供乐观读实现</a></li><li>修正几个单词拼写错误</li></ul></li><li>Breaking Changes<ul><li>无</li></ul></li><li>致谢（排名不分先后）<ul><li>@pifuant @huangyunbin @shiftyman @slievrly</li></ul></li></ul><hr><h2 id=1-2-3>1.2.3</h2><p>2019-03-05
开源第一个版本</p><hr><h2 id=1-2-2>1.2.2</h2><p>2019-02-21</p><ul><li>Bug Fixes<ul><li>PeerId 以及 Endpoint 改为不可变对象，避免 getLeaderId 等 api 的并发问题</li><li>sofa-common 升级到 1.0.12，之前依赖的 1.0.9 版本没有发布到公网仓库</li></ul></li><li>Features<ul><li>Jraft-rheakv 完成了 auto range split，在启用 placementDriver（pd）的情况下，pd 可根据每个节点上报的状态信息计算并下发 range split 指令；不启用 pd 的情况下也提供了 RheaKVCliService，可以使用 cli 手动触发 range split</li><li>LogExceptionHandler 泛型支持</li><li>新增 MetricThreadPoolExecutor（继承 LogThreadPoolExecutor），用于打印 uncaught exception 日志并统计 task.run() 耗时，jraft 中所有 ThreadPoolExecutor 全部替换为 MetricThreadPoolExecutor 进行耗时指标统计，这个指标可作为实践中调整线程池配置的重要参考</li></ul></li><li>Breaking Changes<ul><li>移除了 Endpoint/PeerId 的 <code>reset</code> 方法。</li></ul></li></ul><hr><h2 id=1-2-1>1.2.1</h2><p>2019-01-28</p><ul><li>Bug Fixes<ul><li>修复 RaftGroupService 关闭共享的 rpcServer。</li><li>修复 RheaKV 状态机中的的 batch write 导致 apply 顺序变更。</li><li>修复时间使用 API 错误。</li></ul></li><li>Features<ul><li>融合 jraft 与 rheakv 重复功能的代码。</li><li>降低 Follower 复制请求处理过程中的内存消耗。</li><li>RouteTable 中的 conf 读写由原来的 synchronized 优化为读写锁。</li><li>RheaKV 实现 distributed lock 的 <a href=http://martin.kleppmann.com/2016/02/08/how-to-do-distributed-locking.html>lock safe with fencing</a>, 以及自动续租能力。</li><li>RheaKV 新增 memoryDB 存储类型的实现, 默认配置仍为 rocksDB 存储。</li><li>RheaKV 实现 get/put 接口的 client batching, 有很好的性能收益。</li><li>新增 module: jraft-example, 添加了丰富的用例。</li><li>新增 Configured options, 方便非配置文件使用方式。</li><li>新增 benchmark 代码, 根据压测结果更新了部分配置的默认值, <a href=https://github.com/sofastack/sofa-jraft/wiki/Benchmark-%E6%95%B0%E6%8D%AE>压测结果见这里</a>。</li></ul></li><li>Breaking Changes<ul><li>项目的 groupId 由 com.alipay.jraft 变更为 com.alipay.sofa, 包名变更为 com.alipay.sofa.jraft，所以在通信层 1.2.1 版本与之前的版本不能兼容，批量发布过程中新老版本同时存在可能导致出现两个 leader 的情况，如果需要平滑升级的同学请联系我们提供平滑升级方案</li></ul></li></ul><p><strong>此版本推荐升级。</strong></p><hr><h2 id=1-1-0>1.1.0</h2><p>2018-11-20</p><ol><li>升级bolt到1.5.2（<strong>重要， bolt 老版本存在重连引起的死锁问题</strong>）。<br></li><li>新增了一个嵌入式的分布式 KV 组件(RheaKV)<br></li><li>CliServiceImpl 的 getLeader 应该在某个节点失败情况下自动重试下一个节点<br></li><li>新增 <code>NodeImpl#getCurrentConf()</code> 方法用于获取当前节点的配置列表<strong>，仅用于调试查看</strong>。<br></li><li>改进 disruptor 线程使用，改进服务关闭过程，更友好地关闭线程。<br></li><li>修复 Configuration 变更没有反馈到 Node 内存状态的 bug<br></li><li>升级 RocksDB 到 5.14.2<br></li><li>加强了用户使用 API 的参数校验。<br></li></ol><hr><h2 id=1-0-1>1.0.1</h2><p>2018-10-09</p><ol><li>RocksDB log 存储尊重 RaftOptions 的 sync 选项。<br></li><li>移除 log4j 类库强依赖。<br></li><li>修复一些 typo<br></li></ol><hr><h2 id=1-0-0>1.0.0</h2><p>2018.09.13</p><ol><li>日志压缩异步化，加速 snapshot 处理。<br></li><li>Replicator pipeline 优化。<br></li><li>Task 的 closure 新增 <code>onCommitted</code> 回调，在日志提交到 RAFT group 之后，应用到状态机之前回调。<br></li><li>更加详细的 metrics 统计信息。<br></li><li>线性一致读支持，参见文档。<br></li><li>强制要求 bolt 升级到 1.5.1 版本及以上，因为 pipeline 特性依赖。<br></li></ol><hr><h2 id=0-0-2>0.0.2</h2><p>2018-08-23:</p><ol><li>增加 metrics 统计，参见文档。<br></li><li>改善日志压缩和内部实现部分性能。<br></li></ol><hr><h2 id=0-0-1>0.0.1</h2><ol><li>基础版本发布，实现了 braft 除了 snapshot  流控之外的所有功能。<br></li></ol></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>资源</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>参与进来</h2><a class=link href=https://github.com/dromara/soul/issues/new>反馈</a>
<a class=link href=/community>社区</a>
<a class=link href=/blog>博客</a></div><div class=cate><h2 class=cate-title>文档</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>微信公众号</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ群</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>