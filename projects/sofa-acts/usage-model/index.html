<!doctype html><html><head><title>一键模型化 · SOFAStack</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=https://gw.alipayobjects.com/os/q/cms/images/jqu9346l/4ba95631-2489-4885-881f-bc7f8d787d5e_w64_h61.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="zh"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-142131411-1','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/projects/><span>项目</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/guides/><span>指南</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/blog/><span>博客</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/activities/><span>活动</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/community/><span>社区</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome SOFA</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/projects/sofa-acts/usage-model/><span>English</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/projects/>项目</a>
<a class=navbar-item href=/guides/>指南</a>
<a class=navbar-item href=/blog/>博客</a>
<a class=navbar-item href=/activities/>活动</a>
<a class=navbar-item href=/community/>社区</a>
<a class=navbar-item href=/awesome/>Awesome SOFA</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=请输入要搜索的关键词><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/en/projects/sofa-acts/usage-model/>En</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title=ACTS（AntCoreTest）是一款白盒测试框架，旨在为企业提供高效、精细化的接口自动化测试。>SOFAActs<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>主要项目</h4><ul class=list><li class=item><a href=/projects/sofa-boot/overview>SOFABoot</a></li><li class=item><a href=/projects/sofa-rpc/overview>SOFARPC</a></li><li class=item><a href=/projects/sofa-tracer/overview>SOFATracer</a></li><li class=item><a href=/projects/sofa-lookout/overview>SOFALookout</a></li><li class=item><a href=/projects/sofa-registry/overview>SOFARegistry</a></li></ul></div><div class=toc-list><h4 class=title>孵化项目</h4><ul class=list><li class=item><a href=/projects/sofa-mesh/overview>SOFAMesh</a></li><li class=item><a href=/projects/sofa-dashboard/overview>SOFADashboard</a></li></ul></div><div class=toc-list><h4 class=title>工具项目</h4><ul class=list><li class=item><a href=/projects/sofa-bolt/overview>SOFABolt</a></li><li class=item><a href=/projects/sofa-jraft/overview>SOFAJRaft</a></li><li class=item><a href=/projects/sofa-acts/overview>SOFAActs</a></li><li class=item><a href=https://www.sofastack.tech/projects/sofa-boot/sofa-ark-readme/>SOFAArk</a></li></ul></div><div class=toc-list><h4 class=title>生态项目</h4><ul class=list><li class=item><a href=https://mosn.io>MOSN</a></li><li class=item><a href=https://occlum.io>Occlum</a></li><li class=item><a href=https://seata.io>Seata</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class=link><a title="SOFAActs 介绍" href=/projects/sofa-acts/overview>SOFAActs 介绍</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=用户手册>用户手册</a></div><ul class=leaf-section><li class=item><div class=link><a title=快速开始 href=/projects/sofa-acts/getting-started>快速开始</a></div></li><li class=item><div class=link><a title=框架准备 href=/projects/sofa-acts/usage-ready>框架准备</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=功能特性>功能特性</a></div><ul class=leaf-section><li class=item><div class="link -current"><a title=一键模型化 href=/projects/sofa-acts/usage-model>一键模型化</a></div></li><li class=item><div class=link><a title=一键脚本化 href=/projects/sofa-acts/usage-script>一键脚本化</a></div></li><li class=item><div class=link><a title=一站式编辑 href=/projects/sofa-acts/usage-ide>一站式编辑</a></div></li></ul></li><li class=item><div class=link><a title=扩展功能 href=/projects/sofa-acts/usage-api>扩展功能</a></div></li></ul></li><li class=item><div class=link><a title=开发者手册 href=/projects/sofa-acts/developer-guide>开发者手册</a></div></li><li class=item><div class=link><a title=参与贡献 href=/projects/sofa-acts/contributing>参与贡献</a></div></li><li class=item><div class=link><a title=常见问题 href=/projects/sofa-acts/faq>常见问题</a></div></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>一键模型化</h1><a class="edit-button -hidden-mobile" href=https://github.com/sofastack/sofastack.tech/edit/master/content/zh/projects/sofa-acts/usage-model/index.md>编辑</a></div><div class=meta>更新时间: 2021-01-20</div></div><article class=typo><h2 id=快速理解-acts-的模型>快速理解 ACTS 的模型</h2><p>在写测试用例的过程中，需要预先准备一些 DB 表、方法入参的数据，或者需要校验一些 DB 表、返回结果的数据，这些数据可以以模版的形式保存下来，在编辑用例时，可以方便的导入这些数据到准备数据或者校验数据，实现数据复用。目前 ACTS 模型可以分为 DB 模型和类模型。</p><p>常规的测试用例编写，DB 、方法入参、返回结果等领域模型的数据准备是通过测试代码组织的，随着业务复杂度，领域模型复杂度也在不断增加，尤其在金融级业务用，往往一个类或者数据表有数十个属性或者字段，类与类的嵌套也是随处可见，代码构造复杂对象变得十分困难且容易疏漏，问题频现：
* 表太多容易遗漏，排查时间太长；
* 表的字段名记不住，时不时写错；
* 接口入参数量多类型复杂，看见就头疼；
* 类的属性太多，容易遗漏重要属性；
* 嵌套构造对象，不断的 new 和 set 赋值；
* 继承和实现关系复杂，遗漏重要属性；</p><p>ACTS 的模版有可以有效应对上述问题，通过将类和表固化为 CSV，类的结构一目了然，通过类、数据表的模版可以快速的模版化地创建对象，并序列化到 YAML 文件中，使用 ACTS IDE 可以方便的管理用例数据。</p><h3 id=模型存储位置>模型存储位置</h3><p>在 test 模块的 resource/model 目录可以查看已经存在的模型。</p><p><img src=existing-module.png alt=现有模板></p><p align=center>图4</p><h2 id=数据表模型生成>数据表模型生成</h2><h3 id=数据表模型样例>数据表模型样例</h3><p><img src=sample.png alt=数据表模型样例></p><p align=center>图5</p><p><strong>1. 校验 flag 说明</strong></p><pre><code>```plain
Y: 插入
N：不插入
C：以此为 where 条件对插入后的数据进行清理
F：数据库函数
L: 大字段换行准备，准备方式为 A=B;C=D
```
</code></pre><p><strong>2. 用例编辑使用模型快速导入数据</strong></p><p>使用 ACTS IDE 编辑 DB 表数据（包括准备表数据、期望表数据）时，可右键新增指定表的模型，用于直接从表模型的 CSV 中导入表的全部字段和值，以便快速编辑。
DB 模版的使用可参考准备 DB 数据。</p><h3 id=生成表模型>生成表模型</h3><p><img src=generate-db-table-model.png alt="生成 DB 表结构模型"></p><p align=center>图6</p><p><img src=select-test-module.png alt="选择 test module"></p><p align=center>图7</p><p><img src=select-table.png alt=选择表></p><p align=center>图8</p><p>点击 OK 后生成模板，如图9：</p><p><img src=generated-model.png alt=生成模型></p><p align=center>图9</p><p>同时支持不配置直连获取表结构的方式生成表模型，即在 DO 类上右键根据类生成表模型：
DO 类上右击 -&gt; ACTS 功能 -&gt; 生成 DO 模型：</p><p><img src=generate-do-model.png alt="生成 DO 模型"></p><p align=center>图10</p>![生产的模型](generated-do-model.png)<p align=center>图11</p><h2 id=对象模型生成>对象模型生成</h2><h3 id=对象模型样例>对象模型样例</h3><p><img src=object-model-sample.png alt=对象模型样例></p><p align=center>图12</p><p><img src=model-data.png alt=模型数据></p><p align=center>图13</p><p>一个复杂对象是一个闭包，不但包含其自身模型还包含其嵌套对象的模型。</p><p>ACTS 使用模型快速导入数据、编辑复杂对象（包括入参、返回结果和异常等），在 ACTS IDE 中可右键选择类模型，用于构建该类的对象并赋值以便快速编辑。</p><h3 id=生成方法>生成方法</h3><p>有两种方式：
1.待构建模型的类定义的任意方法上点击；
1.接口定义的方法上点击，详细操作看下图示例。</p><p>使用 IDEA 的同学请注意：请先确保代码已编译，IDEA 不会自动编译而需要手动 <code>mvn clean install</code> 或者打开自动编译 File -&gt; Settings -&gt; Build,Execution,Deployment -&gt; Compiler -&gt; Make project automatically。</p><h4 id=acts-ide-生成对象模型>ACTS IDE 生成对象模型</h4><p>（1）待构建模型的类定义的任意方法上点击，生成当前类的模型</p><p><img src=generate-class-model.png alt=模板生成></p><p align=center>图14</p><p>（2）接口定义任意方法上点击，生成当前接口中，所有方法的复杂入参、复杂返回结果的模型</p><p><img src=interface.png alt=接口></p><p align=center>图15</p></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>资源</h2><a class=link href=https://github.com/sofastack>Github</a>
<a class=link href=https://gitee.com/sofastack/>Gitee</a>
<a class=link href=https://github.com/sofastack-guides>示例</a></div><div class=cate><h2 class=cate-title>社交媒体</h2><a class=link href=https://zhuanlan.zhihu.com/sofastack>知乎专栏</a>
<a class=link href=https://weibo.com/sofastack>新浪微博</a>
<a class=link href=https://twitter.com/sofastack_io>Twitter</a></div><div class=cate><h2 class=cate-title>参与进来</h2><a class=link href=https://github.com/sofastack/sofastack.tech/issues/new>反馈</a>
<a class=link href=https://github.com/sofastack/community>社区</a>
<a class=link href=https://github.com/sofastack/sofastack.tech/wiki>Wiki</a>
<a class=link href=mailto:sofa@alipay.cloud.com>Email</a>
<a class=link href=/hr/>加入我们</a></div><div class=cate><h2 class=cate-title>蚂蚁金服开源项目</h2><a class=link href=https://ant.design/>Ant Design</a>
<a class=link href=https://eggjs.org/>Egg</a>
<a class=link href=https://sqlflow.org>SQLFlow</a>
<a class=link href=https://tech.antfin.com/open-source>更多</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>微信公众号</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>钉钉群</p></div></div></div><div class=copyright><p>© 2019 - 2020 The SOFAStack Authors
<a href=http://beian.miit.gov.cn/>浙 ICP 备 16045294 号-3</a></p></div></footer></body></html>