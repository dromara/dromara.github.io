import{_ as p}from"./X-File-Storage-Cover-e8f4fed8.js";import{_ as o,r as c,o as l,c as i,a as n,b as s,e as t,f as e}from"./app-4b5640bf.js";const u={},r=e('<h3 align="center"><img src="'+p+'" height="200px" alt="logo"><br><span>åŸå X Spring File Storage ç°å·²æèµ è‡³ <a target="_blank" href="https://dromara.org/zh">dromara</a> å¼€æºç»„ç»‡</span></h3><h2 id="ğŸ“š-ç®€ä»‹" tabindex="-1"><a class="header-anchor" href="#ğŸ“š-ç®€ä»‹" aria-hidden="true">#</a> ğŸ“š ç®€ä»‹</h2>',2),k={href:"https://x-file-storage.xuyanwu.cn/#/%E5%AD%98%E5%82%A8%E5%B9%B3%E5%8F%B0",target:"_blank",rel:"noopener noreferrer"},d={href:"https://alist-doc.nn.ci/docs/webdav",target:"_blank",rel:"noopener noreferrer"},m=n("p",null,"GitHubï¼šhttps://github.com/dromara/x-file-storage Giteeï¼šhttps://gitee.com/dromara/x-file-storage",-1),v=n("p",null,"æ–‡æ¡£ 1ï¼šhttps://x-file-storage.dromara.org æ–‡æ¡£ 2ï¼šhttps://x-file-storage.xuyanwu.cn æ–‡æ¡£ 3ï¼šhttps://spring-file-storage.xuyanwu.cn",-1),g=n("hr",null,null,-1),b=n("h2",{id:"ğŸ“œ-æ›´æ–°å†…å®¹",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ğŸ“œ-æ›´æ–°å†…å®¹","aria-hidden":"true"},"#"),s(" ğŸ“œ æ›´æ–°å†…å®¹")],-1),f=n("li",null,"æ›´æ”¹é¡¹ç›®åã€æ›´æ”¹åŒ…åã€ä¼˜åŒ–é¡¹ç›®ç»“æ„",-1),h=n("li",null,"æ–°å¢ç›´æ¥è¯»å– HttpServletRequest çš„æµè¿›è¡Œä¸Šä¼ ï¼Œæ–‡ä»¶ä¸è½ç›˜ï¼Œé€Ÿåº¦æ›´å¿«",-1),y=n("li",null,"æ–°å¢æ”¯æŒ Metadata å…ƒæ•°æ®",-1),S=n("li",null,"ä¼˜åŒ– ACL å¼‚å¸¸å¤„ç†",-1),_=n("li",null,"ä¼˜åŒ–æ–‡ä»¶åˆ é™¤é€»è¾‘",-1),x=n("li",null,"ä¿®å¤ Amazon S3 ä¸Šä¼ æ–‡ä»¶å¶ç° ResetException é—®é¢˜",-1),q={href:"https://dromara.org/zh",target:"_blank",rel:"noopener noreferrer"},w=e(`<h4 id="é¡¹ç›®ä¾èµ–çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#é¡¹ç›®ä¾èµ–çš„å˜åŒ–" aria-hidden="true">#</a> é¡¹ç›®ä¾èµ–çš„å˜åŒ–</h4><p>2.0.0 ä¹‹å‰çš„ç‰ˆæœ¬</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.xuyanwu<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 åŠä»¥åçš„ç‰ˆæœ¬</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.dromara.x-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-file-storage-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="é…ç½®å‚æ•°çš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#é…ç½®å‚æ•°çš„å˜åŒ–" aria-hidden="true">#</a> é…ç½®å‚æ•°çš„å˜åŒ–</h4><p>2.0.0 ä¹‹å‰çš„ç‰ˆæœ¬</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">file-storage</span><span class="token punctuation">:</span> <span class="token comment">#æ–‡ä»¶å­˜å‚¨é…ç½®</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> huawei<span class="token punctuation">-</span>obs<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨å¹³å°</span>
    <span class="token key atrule">thumbnail-suffix</span><span class="token punctuation">:</span> <span class="token string">&quot;.min.jpg&quot;</span> <span class="token comment">#ç¼©ç•¥å›¾åç¼€ï¼Œä¾‹å¦‚ã€.min.jpgã€‘ã€.pngã€‘</span>
    <span class="token comment">#å¯¹åº”å¹³å°çš„é…ç½®å†™åœ¨è¿™é‡Œï¼Œæ³¨æ„ç¼©è¿›è¦å¯¹é½</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 åŠä»¥åçš„ç‰ˆæœ¬</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">dromara</span><span class="token punctuation">:</span>
  <span class="token key atrule">x-file-storage</span><span class="token punctuation">:</span> <span class="token comment">#æ–‡ä»¶å­˜å‚¨é…ç½®</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> huawei<span class="token punctuation">-</span>obs<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨å¹³å°</span>
    <span class="token key atrule">thumbnail-suffix</span><span class="token punctuation">:</span> <span class="token string">&quot;.min.jpg&quot;</span> <span class="token comment">#ç¼©ç•¥å›¾åç¼€ï¼Œä¾‹å¦‚ã€.min.jpgã€‘ã€.pngã€‘</span>
    <span class="token comment">#å¯¹åº”å¹³å°çš„é…ç½®å†™åœ¨è¿™é‡Œï¼Œæ³¨æ„ç¼©è¿›è¦å¯¹é½</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="åŒ…åçš„å˜åŒ–" tabindex="-1"><a class="header-anchor" href="#åŒ…åçš„å˜åŒ–" aria-hidden="true">#</a> åŒ…åçš„å˜åŒ–</h4><p>2.0.0 ä¹‹å‰çš„ç‰ˆæœ¬</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>cn<span class="token punctuation">.</span>xuyanwu<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage
cn<span class="token punctuation">.</span>xuyanwu<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>spring
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 åŠä»¥åçš„ç‰ˆæœ¬</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>org<span class="token punctuation">.</span>dromara<span class="token punctuation">.</span>x<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>core
org<span class="token punctuation">.</span>dromara<span class="token punctuation">.</span>x<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>spring
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h2 id="ğŸ“¦-ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#ğŸ“¦-ä½¿ç”¨" aria-hidden="true">#</a> ğŸ“¦ ä½¿ç”¨</h2>`,17),I={href:"https://x-file-storage.xuyanwu.cn/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8",target:"_blank",rel:"noopener noreferrer"},E=n("h4",{id:"ğŸ”§-é…ç½®",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ğŸ”§-é…ç½®","aria-hidden":"true"},"#"),s(" ğŸ”§ é…ç½®")],-1),F=n("code",null,"pom.xml",-1),B=n("code",null,"SpringBoot",-1),A={href:"https://x-file-storage.xuyanwu.cn/#/%E8%84%B1%E7%A6%BBSpringBoot%E5%8D%95%E7%8B%AC%E4%BD%BF%E7%94%A8",target:"_blank",rel:"noopener noreferrer"},j=e(`<div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- å¼•å…¥æœ¬é¡¹ç›® --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.dromara.x-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-file-storage-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- å¼•å…¥ é˜¿é‡Œäº‘ OSS SDKï¼Œå¦‚æœä½¿ç”¨å…¶å®ƒå­˜å‚¨å¹³å°ï¼Œå°±å¼•å…¥å¯¹åº”çš„ SDK  --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun.oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-sdk-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.16.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>application.yml</code> é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹åŸºç¡€é…ç½®</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">dromara</span><span class="token punctuation">:</span>
  <span class="token key atrule">x-file-storage</span><span class="token punctuation">:</span> <span class="token comment">#æ–‡ä»¶å­˜å‚¨é…ç½®</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> aliyun<span class="token punctuation">-</span>oss<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#é»˜è®¤ä½¿ç”¨çš„å­˜å‚¨å¹³å°</span>
    <span class="token key atrule">aliyun-oss</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> aliyun<span class="token punctuation">-</span>oss<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment"># å­˜å‚¨å¹³å°æ ‡è¯†</span>
        <span class="token key atrule">enable-storage</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># å¯ç”¨å­˜å‚¨</span>
        <span class="token key atrule">access-key</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">secret-key</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">end-point</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">bucket-name</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">domain</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span> <span class="token comment"># è®¿é—®åŸŸåï¼Œæ³¨æ„â€œ/â€ç»“å°¾ï¼Œä¾‹å¦‚ï¼šhttps://abc.oss-cn-shanghai.aliyuncs.com/</span>
        <span class="token key atrule">base-path</span><span class="token punctuation">:</span> test/ <span class="token comment"># åŸºç¡€è·¯å¾„</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ğŸ”¨-ç¼–ç " tabindex="-1"><a class="header-anchor" href="#ğŸ”¨-ç¼–ç " aria-hidden="true">#</a> ğŸ”¨ ç¼–ç </h4><p>åœ¨å¯åŠ¨ç±»ä¸ŠåŠ ä¸Š<code>@EnableFileStorage</code>æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableFileStorage</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringFileStorageTestApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringFileStorageTestApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="âœ¨-å¼€å§‹ä¸Šä¼ " tabindex="-1"><a class="header-anchor" href="#âœ¨-å¼€å§‹ä¸Šä¼ " aria-hidden="true">#</a> âœ¨ å¼€å§‹ä¸Šä¼ </h4>`,7),O={href:"https://x-file-storage.xuyanwu.cn/#/%E6%96%87%E4%BB%B6%E9%80%82%E9%85%8D%E5%99%A8",target:"_blank",rel:"noopener noreferrer"},M=e(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileDetailController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">FileStorageService</span> fileStorageService<span class="token punctuation">;</span><span class="token comment">//æ³¨å…¥å®åˆ—</span>

    <span class="token doc-comment comment">/**
     * ä¸Šä¼ æ–‡ä»¶
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//åªéœ€è¦è¿™ä¸€è¡Œä»£ç å³å¯ä¸Šä¼ æˆåŠŸ</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä¸Šä¼ æ–‡ä»¶ï¼ŒæˆåŠŸè¿”å›æ–‡ä»¶ url
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload2</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;upload/&quot;</span><span class="token punctuation">)</span> <span class="token comment">//ä¿å­˜åˆ°ç›¸å¯¹è·¯å¾„ä¸‹ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸éœ€è¦å¯ä»¥ä¸å†™</span>
                <span class="token punctuation">.</span><span class="token function">setObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span>   <span class="token comment">//å…³è”å¯¹è±¡idï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸éœ€è¦å¯ä»¥ä¸å†™</span>
                <span class="token punctuation">.</span><span class="token function">setObjectType</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token comment">//å…³è”å¯¹è±¡ç±»å‹ï¼Œä¸ºäº†æ–¹ä¾¿ç®¡ç†ï¼Œä¸éœ€è¦å¯ä»¥ä¸å†™</span>
                <span class="token punctuation">.</span><span class="token function">putAttr</span><span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span> <span class="token comment">//ä¿å­˜ä¸€äº›å±æ€§ï¼Œå¯ä»¥åœ¨åˆ‡é¢ã€ä¿å­˜ä¸Šä¼ è®°å½•ã€è‡ªå®šä¹‰å­˜å‚¨å¹³å°ç­‰åœ°æ–¹è·å–ä½¿ç”¨ï¼Œä¸éœ€è¦å¯ä»¥ä¸å†™</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//å°†æ–‡ä»¶ä¸Šä¼ åˆ°å¯¹åº”åœ°æ–¹</span>
        <span class="token keyword">return</span> fileInfo <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">&quot;ä¸Šä¼ å¤±è´¥ï¼&quot;</span> <span class="token operator">:</span> fileInfo<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä¸Šä¼ å›¾ç‰‡ï¼ŒæˆåŠŸè¿”å›æ–‡ä»¶ä¿¡æ¯
     * å›¾ç‰‡å¤„ç†ä½¿ç”¨çš„æ˜¯ https://github.com/coobird/thumbnailator
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-image&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadImage</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span>img <span class="token operator">-&gt;</span> img<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//å°†å›¾ç‰‡å¤§å°è°ƒæ•´åˆ° 1000*1000</span>
                <span class="token punctuation">.</span><span class="token function">thumbnail</span><span class="token punctuation">(</span>th <span class="token operator">-&gt;</span> th<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//å†ç”Ÿæˆä¸€å¼  200*200 çš„ç¼©ç•¥å›¾</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä¸Šä¼ æ–‡ä»¶åˆ°æŒ‡å®šå­˜å‚¨å¹³å°ï¼ŒæˆåŠŸè¿”å›æ–‡ä»¶ä¿¡æ¯
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-platform&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadPlatform</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span><span class="token string">&quot;aliyun-oss-1&quot;</span><span class="token punctuation">)</span>    <span class="token comment">//ä½¿ç”¨æŒ‡å®šçš„å­˜å‚¨å¹³å°</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç›´æ¥è¯»å– HttpServletRequest ä¸­çš„æ–‡ä»¶è¿›è¡Œä¸Šä¼ ï¼ŒæˆåŠŸè¿”å›æ–‡ä»¶ä¿¡æ¯
     * ä½¿ç”¨è¿™ç§æ–¹å¼æœ‰äº›æ³¨æ„äº‹é¡¹ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£ åŸºç¡€åŠŸèƒ½-ä¸Šä¼  ç« èŠ‚
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-request&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadPlatform</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ğŸ¨-å…¶å®ƒæ“ä½œ" tabindex="-1"><a class="header-anchor" href="#ğŸ¨-å…¶å®ƒæ“ä½œ" aria-hidden="true">#</a> ğŸ¨ å…¶å®ƒæ“ä½œ</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//æ‰‹åŠ¨æ„é€ æ–‡ä»¶ä¿¡æ¯ï¼Œå¯ç”¨äºå…¶å®ƒæ“ä½œ</span>
<span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span><span class="token string">&quot;huawei-obs-1&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setBasePath</span><span class="token punctuation">(</span><span class="token string">&quot;test/&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;aa/&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setFilename</span><span class="token punctuation">(</span><span class="token string">&quot;image.png&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setThFilename</span><span class="token punctuation">(</span><span class="token string">&quot;image.png.min.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
<span class="token keyword">boolean</span> exists <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ä¸‹è½½</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ é™¤</span>
fileStorageService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//å…¶å®ƒæ›´å¤šæ“ä½œ</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),P={href:"https://x-file-storage.xuyanwu.cn/#/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD?id=%E4%BF%9D%E5%AD%98%E4%B8%8A%E4%BC%A0%E8%AE%B0%E5%BD%95",target:"_blank",rel:"noopener noreferrer"},D=e(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//ç›´æ¥ä»æ•°æ®åº“ä¸­è·å– FileInfo å¯¹è±¡ï¼Œæ›´åŠ æ–¹ä¾¿æ‰§è¡Œå…¶å®ƒæ“ä½œ</span>
<span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">getFileInfoByUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span>
<span class="token keyword">boolean</span> exists <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//ä¸‹è½½</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ é™¤</span>
fileStorageService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//å…¶å®ƒæ›´å¤šæ“ä½œ</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),C={href:"https://x-file-storage.xuyanwu.cn/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8",target:"_blank",rel:"noopener noreferrer"};function R(U,T){const a=c("ExternalLinkIcon");return l(),i("div",null,[r,n("p",null,[s("ä¸€è¡Œä»£ç å°†æ–‡ä»¶å­˜å‚¨åˆ°æœ¬åœ°ã€FTPã€SFTPã€WebDAVã€é˜¿é‡Œäº‘ OSSã€åä¸ºäº‘ OBSã€ä¸ƒç‰›äº‘ Kodoã€è…¾è®¯äº‘ COSã€ç™¾åº¦äº‘ BOSã€åˆæ‹äº‘ USSã€MinIOã€ Amazon S3ã€GoogleCloud Storageã€é‡‘å±±äº‘ KS3ã€ç¾å›¢äº‘ MSSã€äº¬ä¸œäº‘ OSSã€å¤©ç¿¼äº‘ OOSã€ç§»åŠ¨ äº‘ EOSã€æ²ƒäº‘ OSSã€ ç½‘æ˜“æ•°å¸† NOSã€Ucloud US3ã€é’äº‘ QingStorã€å¹³å®‰äº‘ OBSã€é¦–äº‘ OSSã€IBM COSã€å…¶å®ƒå…¼å®¹ S3 åè®®çš„å­˜å‚¨å¹³å°ã€‚æŸ¥çœ‹ "),n("a",k,[s("æ‰€æœ‰æ”¯æŒçš„å­˜å‚¨å¹³å°"),t(a)])]),n("p",null,[s("ğŸ’¡ é€šè¿‡ WebDAV è¿æ¥åˆ° Alist åï¼Œå¯ä»¥ä½¿ç”¨ç™¾åº¦ç½‘ç›˜ã€å¤©ç¿¼äº‘ç›˜ã€é˜¿é‡Œäº‘ç›˜ã€è¿…é›·ç½‘ç›˜ç­‰å¸¸è§å­˜å‚¨æœåŠ¡ï¼ŒæŸ¥çœ‹ "),n("a",d,[s("Alist æ”¯æŒçš„å­˜å‚¨å¹³å°"),t(a)])]),m,v,g,b,n("ul",null,[f,h,y,S,_,x,n("li",null,[s("æèµ è‡³ "),n("a",q,[s("dromara"),t(a)]),s(" å¼€æºç¤¾åŒº")])]),w,n("p",null,[s("ç‚¹å‡» "),n("a",I,[s("å¿«é€Ÿå…¥é—¨"),t(a)]),s(" æŸ¥çœ‹å…¨éƒ¨å­˜å‚¨å¹³å°çš„ä½¿ç”¨æ–¹æ³•ï¼")]),E,n("p",null,[s("è¿™é‡Œä»¥é˜¿é‡Œäº‘ OSS ä¸ºä¾‹ï¼Œ"),F,s(" å¼•å…¥æœ¬é¡¹ç›®ï¼Œè¿™é‡Œé»˜è®¤æ˜¯ "),B,s(" ç¯å¢ƒï¼Œå…¶å®ƒç¯å¢ƒå‚è€ƒ "),n("a",A,[s("è„±ç¦» SpringBoot å•ç‹¬ä½¿ç”¨"),t(a)])]),j,n("p",null,[s("æ”¯æŒ Fileã€MultipartFileã€byte[]ã€InputStreamã€URLã€URIã€Stringã€HttpServletRequestï¼Œå¤§æ–‡ä»¶ä¼šè‡ªåŠ¨åˆ†ç‰‡ä¸Šä¼ ã€‚å¦‚æœæƒ³æ”¯æŒæ›´å¤šæ–¹å¼ï¼Œè¯·é˜…è¯» "),n("a",O,[s("æ–‡ä»¶é€‚é…å™¨"),t(a)]),s(" ç« èŠ‚")]),M,n("p",null,[s("å¦‚æœå°†æ–‡ä»¶è®°å½•ä¿å­˜åˆ°æ•°æ®åº“ä¸­ï¼Œè¿˜å¯ä»¥æ›´æ–¹ä¾¿çš„æ ¹æ® URL è¿›è¡Œæ“ä½œäº†ï¼Œè¯¦æƒ…è¯·é˜…è¯» "),n("a",P,[s("ä¿å­˜ä¸Šä¼ è®°å½•"),t(a)]),s(" ç« èŠ‚")]),D,n("p",null,[s("ç‚¹å‡» "),n("a",C,[s("å¿«é€Ÿå…¥é—¨"),t(a)]),s(" æŸ¥çœ‹å…¨éƒ¨å­˜å‚¨å¹³å°çš„ä½¿ç”¨æ–¹æ³•ï¼")])])}const H=o(u,[["render",R],["__file","x-file-storage-2.0.0.html.vue"]]);export{H as default};
