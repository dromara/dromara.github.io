import{_ as o}from"./X-File-Storage-Cover-e8f4fed8.js";import{_ as p,r as c,o as i,c as l,a as n,b as s,e as t,f as e}from"./app-74d64f08.js";const u={},r=e('<h3 align="center"><img src="'+o+'" height="200px" alt="logo"><br><span>Originally known as X Spring File Storage, it has been donated to the <a target="_blank" href="https://dromara.org/zh">dromara</a> open source organization</span></h3><h1 id="ðŸ“šsummary" tabindex="-1"><a class="header-anchor" href="#ðŸ“šsummary" aria-hidden="true">#</a> ðŸ“šSummary</h1>',2),d={href:"https://x-file-storage.xuyanwu.cn/#/%E5%AD%98%E5%82%A8%E5%B9%B3%E5%8F%B0",target:"_blank",rel:"noopener noreferrer"},k={href:"https://alist-doc.nn.ci/docs/webdav",target:"_blank",rel:"noopener noreferrer"},m=n("p",null,"GitHubï¼šhttps://github.com/dromara/x-file-storage Giteeï¼šhttps://gitee.com/dromara/x-file-storage",-1),v=n("p",null,"Document1ï¼šhttps://x-file-storage.dromara.org Document2ï¼šhttps://x-file-storage.xuyanwu.cn Document3ï¼šhttps://spring-file-storage.xuyanwu.cn",-1),g=n("hr",null,null,-1),f=n("h1",{id:"ðŸ“œupdatecontent",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ðŸ“œupdatecontent","aria-hidden":"true"},"#"),s(" ðŸ“œUpdateContent")],-1),b=n("li",null,"Change project name, change package name, optimize project structure",-1),h=n("li",null,"Added the ability to directly read the HttpServletRequest stream for uploading, so the file does not fall to disk and is faster",-1),y=n("li",null,"Added support for Metadata",-1),S=n("li",null,"Optimize ACL exception handling",-1),x=n("li",null,"Optimize file deletion logic",-1),_=n("li",null,"Fixed the issue of ResetException occasionally occurring when uploading files to Amazon S3",-1),w={href:"https://dromara.org/zh",target:"_blank",rel:"noopener noreferrer"},q=e(`<h4 id="changes-in-project-dependencies" tabindex="-1"><a class="header-anchor" href="#changes-in-project-dependencies" aria-hidden="true">#</a> Changes in project dependencies</h4><p>Versions before 2.0.0</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>cn.xuyanwu<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 and later versions</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.dromara.x-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-file-storage-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="changes-in-configuration-parameters" tabindex="-1"><a class="header-anchor" href="#changes-in-configuration-parameters" aria-hidden="true">#</a> Changes in configuration parameters</h4><p>Versions before 2.0.0</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">file-storage</span><span class="token punctuation">:</span> <span class="token comment">#File storage configuration</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> huawei<span class="token punctuation">-</span>obs<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#Default storage platform used</span>
    <span class="token key atrule">thumbnail-suffix</span><span class="token punctuation">:</span> <span class="token string">&quot;.min.jpg&quot;</span> <span class="token comment">#Thumbnail suffix, such as [.min.jpg] [.png]</span>
    <span class="token comment">#The configuration of the corresponding platform is written here, pay attention to the indentation to be aligned</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 and later versions</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">dromara</span><span class="token punctuation">:</span>
  <span class="token key atrule">x-file-storage</span><span class="token punctuation">:</span> <span class="token comment">#File storage configuration</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> huawei<span class="token punctuation">-</span>obs<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#Default storage platform used</span>
    <span class="token key atrule">thumbnail-suffix</span><span class="token punctuation">:</span> <span class="token string">&quot;.min.jpg&quot;</span> <span class="token comment">#Thumbnail suffix, such as [.min.jpg] [.png]</span>
    <span class="token comment">#The configuration of the corresponding platform is written here, pay attention to the indentation to be aligned</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="changes-in-package-name" tabindex="-1"><a class="header-anchor" href="#changes-in-package-name" aria-hidden="true">#</a> Changes in package name</h4><p>Versions before 2.0.0</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>cn<span class="token punctuation">.</span>xuyanwu<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage
cn<span class="token punctuation">.</span>xuyanwu<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>spring
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>2.0.0 and later versions</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>org<span class="token punctuation">.</span>dromara<span class="token punctuation">.</span>x<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>core
org<span class="token punctuation">.</span>dromara<span class="token punctuation">.</span>x<span class="token punctuation">.</span>file<span class="token punctuation">.</span>storage<span class="token punctuation">.</span>spring
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><hr><h1 id="ðŸ“¦use" tabindex="-1"><a class="header-anchor" href="#ðŸ“¦use" aria-hidden="true">#</a> ðŸ“¦Use</h1>`,17),F={href:"https://x-file-storage.xuyanwu.cn/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8",target:"_blank",rel:"noopener noreferrer"},I=n("h4",{id:"ðŸ”§-configuration",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ðŸ”§-configuration","aria-hidden":"true"},"#"),s(" ðŸ”§ Configuration")],-1),A=n("code",null,"pom.xml",-1),E=n("code",null,"SpringBoot",-1),B={href:"https://x-file-storage.xuyanwu.cn/#/%E8%84%B1%E7%A6%BBSpringBoot%E5%8D%95%E7%8B%AC%E4%BD%BF%E7%94%A8",target:"_blank",rel:"noopener noreferrer"},C=e(`<div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--Introduce this project --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.dromara.x-file-storage<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>x-file-storage-spring<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--Introduce Alibaba Cloud OSS SDK. If you use other storage platforms, introduce the corresponding SDK --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun.oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-sdk-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.16.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Add the following basic configuration to the <code>application.yml</code> configuration file</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">dromara</span><span class="token punctuation">:</span>
  <span class="token key atrule">x-file-storage</span><span class="token punctuation">:</span> <span class="token comment">#File storage configuration</span>
    <span class="token key atrule">default-platform</span><span class="token punctuation">:</span> aliyun<span class="token punctuation">-</span>oss<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment">#Default storage platform</span>
    <span class="token key atrule">aliyun-oss</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">platform</span><span class="token punctuation">:</span> aliyun<span class="token punctuation">-</span>oss<span class="token punctuation">-</span><span class="token number">1</span> <span class="token comment"># Storage platform identification</span>
        <span class="token key atrule">enable-storage</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># Enable storage</span>
        <span class="token key atrule">access-key</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">secret-key</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">end-point</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">bucket-name</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span>
        <span class="token key atrule">domain</span><span class="token punctuation">:</span> <span class="token punctuation">?</span><span class="token punctuation">?</span> <span class="token comment"># Access the domain name, pay attention to the &quot;/&quot; ending, for example: https://abc.oss-cn-shanghai.aliyuncs.com/</span>
        <span class="token key atrule">base-path</span><span class="token punctuation">:</span> test/ <span class="token comment"># base path</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ðŸ”¨encoding" tabindex="-1"><a class="header-anchor" href="#ðŸ”¨encoding" aria-hidden="true">#</a> ðŸ”¨Encoding</h4><p>Add the <code>@EnableFileStorage</code> annotation to the startup class</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@EnableFileStorage</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringFileStorageTestApplication</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">SpringFileStorageTestApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="âœ¨start-uploading" tabindex="-1"><a class="header-anchor" href="#âœ¨start-uploading" aria-hidden="true">#</a> âœ¨Start uploading</h4>`,7),j={href:"https://x-file-storage.xuyanwu.cn/#/%E6%96%87%E4%BB%B6%E9%80%82%E9%85%8D%E5%99%A8",target:"_blank",rel:"noopener noreferrer"},D=e(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileDetailController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">FileStorageService</span> fileStorageService<span class="token punctuation">;</span><span class="token comment">//æ³¨å…¥å®žåˆ—</span>

    <span class="token doc-comment comment">/**
     * upload files
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//Only this line of code is needed to upload successfully</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token doc-comment comment">/**
     * Upload the file and return the file url successfully
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload2&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload2</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;upload/&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Save to a relative path. For the convenience of management, you donâ€™t need to write it.</span>
                <span class="token punctuation">.</span><span class="token function">setObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Associated object id. For the convenience of management, you donâ€™t need to write it.</span>
                <span class="token punctuation">.</span><span class="token function">setObjectType</span><span class="token punctuation">(</span><span class="token string">&quot;0&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Associated object type. For convenience of management, you donâ€™t need to write it.</span>
                <span class="token punctuation">.</span><span class="token function">putAttr</span><span class="token punctuation">(</span><span class="token string">&quot;role&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Save some attributes, which can be obtained and used in aspects, saved upload records, customized storage platforms, etc. You don&#39;t need to write them</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Upload the file to the corresponding place</span>
        <span class="token keyword">return</span> fileInfo <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">&quot;Upload failed!&quot;</span> <span class="token operator">:</span> fileInfo<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Upload pictures and return file information successfully
     *Image processing uses https://github.com/coobird/thumbnailator
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-image&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadImage</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">image</span><span class="token punctuation">(</span>img <span class="token operator">-&gt;</span> img<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//Adjust the image size to 1000*1000</span>
                <span class="token punctuation">.</span><span class="token function">thumbnail</span><span class="token punctuation">(</span>th <span class="token operator">-&gt;</span> th<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//Generate a 200*200 thumbnail</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Upload files to the designated storage platform and return file information successfully
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-platform&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadPlatform</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span><span class="token string">&quot;aliyun-oss-1&quot;</span><span class="token punctuation">)</span> <span class="token comment">//Use the specified storage platform</span>
                <span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * Directly read the file in HttpServletRequest for upload, and successfully return the file information
     * There are some precautions when using this method. Please check the Basic Functions-Upload chapter of the document.
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/upload-request&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">FileInfo</span> <span class="token function">uploadPlatform</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> fileStorageService<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="ðŸŽ¨other-operations" tabindex="-1"><a class="header-anchor" href="#ðŸŽ¨other-operations" aria-hidden="true">#</a> ðŸŽ¨Other operations</h4><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//Manually construct file information, which can be used for other operations</span>
<span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setPlatform</span><span class="token punctuation">(</span><span class="token string">&quot;huawei-obs-1&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setBasePath</span><span class="token punctuation">(</span><span class="token string">&quot;test/&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setPath</span><span class="token punctuation">(</span><span class="token string">&quot;aa/&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setFilename</span><span class="token punctuation">(</span><span class="token string">&quot;image.png&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setThFilename</span><span class="token punctuation">(</span><span class="token string">&quot;image.png.min.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Does the file exist?</span>
<span class="token keyword">boolean</span> exists <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//download</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//delete</span>
fileStorageService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>fileInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Other more operations</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),O={href:"https://x-file-storage.xuyanwu.cn/#/%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD?id=%E4%BF%9D%E5%AD%98%E4%B8%8A%E4%BC%A0%E8%AE%B0%E5%BD%95",target:"_blank",rel:"noopener noreferrer"},U=e(`<div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//Get the FileInfo object directly from the database, making it easier to perform other operations</span>
<span class="token class-name">FileInfo</span> fileInfo <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">getFileInfoByUrl</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//Does the file exist?</span>
<span class="token keyword">boolean</span> exists <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//download</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bytes <span class="token operator">=</span> fileStorageService<span class="token punctuation">.</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//delete</span>
fileStorageService<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;https://abc.def.com/test/aa/image.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//Other more operations</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),M={href:"https://x-file-storage.xuyanwu.cn/#/%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8",target:"_blank",rel:"noopener noreferrer"};function P(T,z){const a=c("ExternalLinkIcon");return i(),l("div",null,[r,n("p",null,[s("One line of code stores files locally, FTP, SFTP, WebDAV, Alibaba Cloud OSS, Huawei Cloud OBS, Qiniu Cloud Kodo, Tencent Cloud COS, Baidu Cloud BOS, Youpai Cloud USS, MinIO, Amazon S3, Google Cloud Storage, Kingsoft Cloud KS3, Meituan Cloud MSS, JD Cloud OSS, Tianyi Cloud OOS, Mobile Cloud EOS, Woyun OSS, NetEase Shufan NOS, Ucloud US3, Qingyun QingStor, Ping An Cloud OBS, Shouyun OSS, IBM COS, and other storage platforms compatible with the S3 protocol. View "),n("a",d,[s("all supported storage platforms"),t(a)])]),n("p",null,[s("ðŸ’¡ After connecting to Alist through WebDAV, you can use common storage services such as Baidu Cloud Disk, Tianyi Cloud Disk, Alibaba Cloud Disk, and Thunder Cloud Disk. Check "),n("a",k,[s("Storage Platforms Supported by Alist"),t(a)])]),m,v,g,f,n("ul",null,[b,h,y,S,x,_,n("li",null,[s("Donate to "),n("a",w,[s("dromara"),t(a)]),s(" open source community")])]),q,n("p",null,[s("Click "),n("a",F,[s("Quick Start"),t(a)]),s(" to view how to use all storage platforms!")]),I,n("p",null,[s("Here we take Alibaba Cloud OSS as an example. "),A,s(" is introduced into this project. The default here is the "),E,s(" environment. For other environments, please refer to "),n("a",B,[s("Use alone without SpringBoot"),t(a)])]),C,n("p",null,[s("Supports File, MultipartFile, byte[], InputStream, URL, URI, String, HttpServletRequest, and large files will be automatically uploaded in parts. If you want to support more methods, please read the "),n("a",j,[s("File Adapter"),t(a)]),s(" chapter")]),D,n("p",null,[s("If you save file records to the database, you can also operate based on the URL more conveniently. For details, please read "),n("a",O,[s("Save Upload Records"),t(a)]),s(" Chapter")]),U,n("p",null,[s("Click "),n("a",M,[s("Quick Start"),t(a)]),s(" to view how to use all storage platforms!")])])}const H=p(u,[["render",P],["__file","x-file-storage-2.0.0.html.vue"]]);export{H as default};
