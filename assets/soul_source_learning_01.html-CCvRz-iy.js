import{_ as i,c as a,a as e,o as t}from"./app-DDc8sQ0r.js";const n="/assets/img/01/16106054898861.jpg",l="/assets/img/01/16106065488032.jpg",h="/assets/img/01/16106069731233.jpg",p="/assets/img/01/16106073045599.jpg",k="/assets/img/01/16106076385761.jpg",r="/assets/img/01/16106235724795.jpg",d="/assets/img/01/16106237733891.jpg",o="/assets/img/01/16106249542903.jpg",g="/assets/img/01/16106250513285.jpg",c="/assets/img/01/16106266610601.jpg",u="/assets/img/01/16106267572581.jpg",y="/assets/img/01/16106270140398.jpg",A="/assets/img/01/16106405075031.jpg",m={};function F(B,s){return t(),a("div",null,s[0]||(s[0]=[e('<h1 id="soul-源码分析-1-环境配置" tabindex="-1"><a class="header-anchor" href="#soul-源码分析-1-环境配置"><span>Soul 源码分析（1） 环境配置</span></a></h1><blockquote><p>soul is a High-Performance Java API Gateway</p><p>GitHub：https://github.com/dromara/soul</p><p>官方文档：https://dromara.org/zh-cn/docs/soul/soul.html</p></blockquote><h2 id="_1-源代码准备" tabindex="-1"><a class="header-anchor" href="#_1-源代码准备"><span>1. 源代码准备</span></a></h2><h3 id="_1-1-fork-dromara-soul源代码至自己的仓库cchenxi-soul" tabindex="-1"><a class="header-anchor" href="#_1-1-fork-dromara-soul源代码至自己的仓库cchenxi-soul"><span>1.1. fork <a href="https://github.com/dromara/soul.git" target="_blank" rel="noopener noreferrer">dromara/soul</a>源代码至自己的仓库<a href="https://github.com/cchenxi/soul.git" target="_blank" rel="noopener noreferrer">cchenxi/soul</a></span></a></h3><h3 id="_1-2-clone-自己仓库中的-soul-源代码至本地" tabindex="-1"><a class="header-anchor" href="#_1-2-clone-自己仓库中的-soul-源代码至本地"><span>1.2. clone 自己仓库中的 soul 源代码至本地</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">git</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clone</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://github.com/cchenxi/soul.git</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_1-3-使用-idea-打开-soul-源代码" tabindex="-1"><a class="header-anchor" href="#_1-3-使用-idea-打开-soul-源代码"><span>1.3.使用 idea 打开 soul 源代码</span></a></h3><h3 id="_1-4-编译-soul-源代码" tabindex="-1"><a class="header-anchor" href="#_1-4-编译-soul-源代码"><span>1.4.编译 soul 源代码</span></a></h3><p>执行以下 maven 命令，等待编译完成</p><p><img src="'+n+'" alt="-w1723"></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mvn</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> clean</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> package</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Dmaven.test.skip=true</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Dmaven.javadoc.skip=true</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Drat.skip=true</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Dcheckstyle.skip=true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="_2-启动-soul" tabindex="-1"><a class="header-anchor" href="#_2-启动-soul"><span>2. 启动 <code>soul</code></span></a></h2><h3 id="_2-1-启动soul-admin模块" tabindex="-1"><a class="header-anchor" href="#_2-1-启动soul-admin模块"><span>2.1. 启动<code>soul-admin</code>模块</span></a></h3><blockquote><p><code>soul-admin</code>是 soul 网关的后台管理系统</p></blockquote><p>选择使用 MySQL 数据库存储网关数据，修改数据源配置为自己的数据库配置。</p><p><img src="'+l+'" alt="-w1186"></p><p>运行启动类 <code>org.dromara.soul.admin.SoulAdminBootstrap</code>。</p><p>启动成功后，访问地址 http://localhost:9095/ ，跳转到登录页 ↓</p><p><img src="'+h+'" alt="-w593"></p><p>使用用户名<code>admin</code>，密码 <code>123456</code> 登录。</p><p><img src="'+p+'" alt="-w1262"></p><h3 id="_2-2-启动soul-bootstrap模块" tabindex="-1"><a class="header-anchor" href="#_2-2-启动soul-bootstrap模块"><span>2.2. 启动<code>soul-bootstrap</code>模块</span></a></h3><blockquote><p><code>soul-bootstrap</code>是网关系统的核心</p></blockquote><p>检查<code>soul-bootstrap</code>的配置</p><p><img src="'+k+`" alt="-w917"></p><p>这里需要配置成 <code>soul-admin</code>的 ip 和端口</p><p>控制台输出如下内容表示 <code>soul-bootstrap</code>启动成功</p><div class="language-plain line-numbers-mode" data-highlighter="shiki" data-ext="plain" data-title="plain" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>2021-01-14 15:01:15.832  INFO 17943 --- [           main] b.s.s.d.w.WebsocketSyncDataConfiguration : you use websocket sync soul data.......</span></span>
<span class="line"><span>2021-01-14 15:01:15.924  INFO 17943 --- [           main] o.d.s.p.s.d.w.WebsocketSyncDataService   : websocket connection is successful.....</span></span>
<span class="line"><span>2021-01-14 15:01:16.113  INFO 17943 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoint(s) beneath base path &#39;/actuator&#39;</span></span>
<span class="line"><span>log4j:WARN No appenders could be found for logger (com.alibaba.dubbo.common.logger.LoggerFactory).</span></span>
<span class="line"><span>log4j:WARN Please initialize the log4j system properly.</span></span>
<span class="line"><span>log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.</span></span>
<span class="line"><span>2021-01-14 15:01:17.150  INFO 17943 --- [           main] o.s.b.web.embedded.netty.NettyWebServer  : Netty started on port(s): 9195</span></span>
<span class="line"><span>2021-01-14 15:01:17.154  INFO 17943 --- [           main] o.d.s.b.SoulBootstrapApplication         : Started SoulBootstrapApplication in 5.508 seconds (JVM running for 6.762)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-测试-http-请求转发" tabindex="-1"><a class="header-anchor" href="#_3-测试-http-请求转发"><span>3. 测试 http 请求转发</span></a></h2><blockquote><p>为了方便测试，把<code>soul-examples</code>模块添加到 soul 的 pom 里</p></blockquote><h3 id="_3-1-启动一个服务" tabindex="-1"><a class="header-anchor" href="#_3-1-启动一个服务"><span>3.1. 启动一个服务</span></a></h3><p>启动<code>soul-examples-http</code>项目</p><p><code>soul-examples-http</code>的 pom 中引入了依赖</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;org.dromara&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">groupId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;soul-spring-boot-starter-client-springmvc&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">artifactId</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    &lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;\${soul.version}&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">version</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">dependency</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 <code>application.yml</code>中配置</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">soul</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">  http</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    adminUrl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">http://localhost:9095</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    port</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8188</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    contextPath</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/http</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    appName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">http</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">    full</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果 soul.http.full=false，则需要在具体的 http 接口上配置 <code>@SoulSpringMvcClient</code> 注解</p><h4 id="_3-1-1-测试-http-服务" tabindex="-1"><a class="header-anchor" href="#_3-1-1-测试-http-服务"><span>3.1.1. 测试 http 服务</span></a></h4><p>执行 http 请求 <code>http://localhost:8188/test/findByUserId?userId=1</code> 结果如下图</p><p><img src="`+r+'" alt="-w684"></p><h4 id="_3-1-2-测试网关转发" tabindex="-1"><a class="header-anchor" href="#_3-1-2-测试网关转发"><span>3.1.2. 测试网关转发</span></a></h4><p>执行 http 请求 <code>http://localhost:9195/http/test/findByUserId?userId=1</code> 结果如下图</p><p><img src="'+d+`" alt="-w665"> 在<code>soul-bootstrap</code>的控制台中输出如下信息</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:42:57.123</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-11] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:42:57.125</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-11] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:42:57.126</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-11] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8188/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以观察到网关可以将请求正常转发。</p><h3 id="_3-2-启动两个服务模拟负载均衡" tabindex="-1"><a class="header-anchor" href="#_3-2-启动两个服务模拟负载均衡"><span>3.2. 启动两个服务模拟负载均衡</span></a></h3><p>勾选 <code>Allow parallel run</code>，修改端口为<code>8189</code>，再次启动<code>soul-examples-http</code>项目</p><p><img src="`+o+'" alt="-w1104"></p><h4 id="_3-2-1-测试-http-服务" tabindex="-1"><a class="header-anchor" href="#_3-2-1-测试-http-服务"><span>3.2.1. 测试 http 服务</span></a></h4><p>执行 http 请求 <code>http://localhost:8189/test/findByUserId?userId=1</code> 结果如下图</p><p><img src="'+g+'" alt="-w693"></p><h4 id="_3-2-2-测试负载均衡" tabindex="-1"><a class="header-anchor" href="#_3-2-2-测试负载均衡"><span>3.2.2. 测试负载均衡</span></a></h4><p><img src="'+c+'" alt="-w1096"></p><p>将 8188 和 8189 两个端口对应的服务配置到选择器中</p><p>多次执行 http 请求 <code>http://localhost:9195/http/test/findByUserId?userId=1</code> 结果如下图</p><p><img src="'+u+`" alt="-w595"> 在<code>soul-bootstrap</code>的控制台中输出如下信息</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:34.460</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-21] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:34.460</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-21] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:34.460</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-21] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8189/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:35.147</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-22] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:35.147</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-22] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:35.147</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-22] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8188/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:38.755</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-23] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:38.756</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-23] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:38.756</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-23] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8188/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:39.609</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-24] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:39.609</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-24] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:39.609</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-24] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8189/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-25] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-25] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.317</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [work-threads-25] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8188/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.976</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-work-threads-1] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.976</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-work-threads-1] o.d.soul.plugin.base.AbstractSoulPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> divide selector success match , selector name :/http/test/**</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2021-01-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 20:48:40.977</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  INFO</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 29812</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> ---</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [-work-threads-1] o.d.s.plugin.httpclient.WebClientPlugin  </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> The request urlPath is http://172.27.121.155:8188/test/findByUserId?</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">userId</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">1,</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> retryTimes</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> is</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以观察到请求既有转发到 8188 端口的，也有转发到 8189 的，可以实现负载均衡</p><h4 id="_3-2-3-压测" tabindex="-1"><a class="header-anchor" href="#_3-2-3-压测"><span>3.2.3. 压测</span></a></h4><p>简单对直连和使用网关两种方式的请求进行压测</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  soul</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">✗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrk</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c40</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d30s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:8189/test/findByUserId</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">userId</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Running</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> @</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:8189/test/findByUserId?userId=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> threads</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connections</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Thread</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Stats</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   Avg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      Stdev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Max</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   +/-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Stdev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    Latency</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     6.06ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   28.81ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 442.25ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   98.22%</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    Req/Sec</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     2.05k</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   493.86</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     2.84k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    74.82%</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  486269</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> requests</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30.05s,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 51.01MB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Requests/sec:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">  16179.68</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Transfer/sec:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      1.70MB</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">➜</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">  soul</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> git:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">master</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">✗</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> wrk</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -t8</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -c40</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -d30s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:9195/http/test/findByUserId</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\?</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">userId</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Running</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> test</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> @</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://localhost:9195/http/test/findByUserId?userId=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  8</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> threads</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> and</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 40</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> connections</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  Thread</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Stats</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   Avg</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">      Stdev</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     Max</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   +/-</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Stdev</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    Latency</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    14.37ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   18.11ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 255.66ms</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   93.06%</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    Req/Sec</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   459.41</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">    139.11</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">     1.01k</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    74.23%</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">  109533</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> requests</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> in</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 30.09s,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 11.49MB</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> read</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Requests/sec:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">   3639.60</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">Transfer/sec:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    390.98KB</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>可以发现，使用网关后性能有些下降，主要是因为多了一层转发。</p><h4 id="_3-2-4-问题" tabindex="-1"><a class="header-anchor" href="#_3-2-4-问题"><span>3.2.4. 问题</span></a></h4><p>在启动 8189 端口时，注册的客户端端口还是 8188</p><p><img src="`+y+'" alt="-w1675"></p><p>先手动配置选择器的配置，后来在群友的帮助下定位到是 <code>soul.http.port</code>没有改</p><p>修改后的配置如下</p><p><img src="'+A+'" alt="-w520"></p>',68)]))}const v=i(m,[["render",F],["__file","soul_source_learning_01.html.vue"]]),C=JSON.parse('{"path":"/zh/blog/soul_source_learning_01.html","title":"Soul网关学习(1)环境配置","lang":"zh-CN","frontmatter":{"title":"Soul网关学习(1)环境配置","author":"陈曦","date":"2021-01-15T00:00:00.000Z","tag":["Soul"],"cover":"/assets/img/architecture/soul-framework.png","head":[["meta",{"name":"博客"}],["link",{"rel":"alternate","hreflang":"en-us","href":"https://vuepress-theme-hope-docs-demo.netlify.app/blog/soul_source_learning_01.html"}],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/zh/blog/soul_source_learning_01.html"}],["meta",{"property":"og:title","content":"Soul网关学习(1)环境配置"}],["meta",{"property":"og:description","content":"Soul 源码分析（1） 环境配置 soul is a High-Performance Java API Gateway GitHub：https://github.com/dromara/soul 官方文档：https://dromara.org/zh-cn/docs/soul/soul.html 1. 源代码准备 1.1. fork dromar..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/architecture/soul-framework.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-09-04T07:29:42.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/architecture/soul-framework.png"}],["meta",{"name":"twitter:image:alt","content":"Soul网关学习(1)环境配置"}],["meta",{"property":"article:author","content":"陈曦"}],["meta",{"property":"article:tag","content":"Soul"}],["meta",{"property":"article:published_time","content":"2021-01-15T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2023-09-04T07:29:42.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Soul网关学习(1)环境配置\\",\\"image\\":[\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106054898861.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106065488032.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106069731233.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106073045599.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106076385761.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106235724795.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106237733891.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106249542903.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106250513285.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106266610601.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106267572581.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106270140398.jpg\\",\\"https://vuepress-theme-hope-docs-demo.netlify.app/assets/img/01/16106405075031.jpg\\"],\\"datePublished\\":\\"2021-01-15T00:00:00.000Z\\",\\"dateModified\\":\\"2023-09-04T07:29:42.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"陈曦\\"}]}"]],"description":"Soul 源码分析（1） 环境配置 soul is a High-Performance Java API Gateway GitHub：https://github.com/dromara/soul 官方文档：https://dromara.org/zh-cn/docs/soul/soul.html 1. 源代码准备 1.1. fork dromar..."},"headers":[{"level":2,"title":"1. 源代码准备","slug":"_1-源代码准备","link":"#_1-源代码准备","children":[{"level":3,"title":"1.1. fork dromara/soul源代码至自己的仓库cchenxi/soul","slug":"_1-1-fork-dromara-soul源代码至自己的仓库cchenxi-soul","link":"#_1-1-fork-dromara-soul源代码至自己的仓库cchenxi-soul","children":[]},{"level":3,"title":"1.2. clone 自己仓库中的 soul 源代码至本地","slug":"_1-2-clone-自己仓库中的-soul-源代码至本地","link":"#_1-2-clone-自己仓库中的-soul-源代码至本地","children":[]},{"level":3,"title":"1.3.使用 idea 打开 soul 源代码","slug":"_1-3-使用-idea-打开-soul-源代码","link":"#_1-3-使用-idea-打开-soul-源代码","children":[]},{"level":3,"title":"1.4.编译 soul 源代码","slug":"_1-4-编译-soul-源代码","link":"#_1-4-编译-soul-源代码","children":[]}]},{"level":2,"title":"2. 启动 soul","slug":"_2-启动-soul","link":"#_2-启动-soul","children":[{"level":3,"title":"2.1. 启动soul-admin模块","slug":"_2-1-启动soul-admin模块","link":"#_2-1-启动soul-admin模块","children":[]},{"level":3,"title":"2.2. 启动soul-bootstrap模块","slug":"_2-2-启动soul-bootstrap模块","link":"#_2-2-启动soul-bootstrap模块","children":[]}]},{"level":2,"title":"3. 测试 http 请求转发","slug":"_3-测试-http-请求转发","link":"#_3-测试-http-请求转发","children":[{"level":3,"title":"3.1. 启动一个服务","slug":"_3-1-启动一个服务","link":"#_3-1-启动一个服务","children":[]},{"level":3,"title":"3.2. 启动两个服务模拟负载均衡","slug":"_3-2-启动两个服务模拟负载均衡","link":"#_3-2-启动两个服务模拟负载均衡","children":[]}]}],"git":{"createdTime":1611216273000,"updatedTime":1693812582000,"contributors":[{"name":"Cicici-Shi","username":"Cicici-Shi","email":"94002846+Cicici-Shi@users.noreply.github.com","commits":1,"url":"https://github.com/Cicici-Shi"},{"name":"Cici","username":"Cici","email":"1901177100@qq.com","commits":1,"url":"https://github.com/Cici"},{"name":"dengliming","username":"dengliming","email":"liming.d.pro@gmail.com","commits":1,"url":"https://github.com/dengliming"},{"name":"fengzhenbing","username":"fengzhenbing","email":"fengzhenbing98@126.com","commits":1,"url":"https://github.com/fengzhenbing"},{"name":"nuo-promise","username":"nuo-promise","email":"46160170+nuo-promise@users.noreply.github.com","commits":1,"url":"https://github.com/nuo-promise"},{"name":"George","username":"George","email":"46160170+nuo-promise@users.noreply.github.com","commits":1,"url":"https://github.com/George"}]},"readingTime":{"minutes":4.66,"words":1399},"filePathRelative":"zh/blog/soul_source_learning_01.md","localizedDate":"2021年1月15日","autoDesc":true,"excerpt":"\\n<blockquote>\\n<p>soul is a High-Performance Java API Gateway</p>\\n<p>GitHub：https://github.com/dromara/soul</p>\\n<p>官方文档：https://dromara.org/zh-cn/docs/soul/soul.html</p>\\n</blockquote>\\n<h2>1. 源代码准备</h2>\\n<h3><a class=\\"header-anchor\\" href=\\"#_1-1-fork-dromara-soul源代码至自己的仓库cchenxi-soul\\"><span>1.1. fork </span></a><a href=\\"https://github.com/dromara/soul.git\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">dromara/soul</a>源代码至自己的仓库<a href=\\"https://github.com/cchenxi/soul.git\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">cchenxi/soul</a></h3>"}');export{v as comp,C as data};
