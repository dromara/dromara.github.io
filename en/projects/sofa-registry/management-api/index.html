<!doctype html><html><head><title>Management commands · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-142131411-1','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-registry/management-api/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-registry/management-api/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title="SOFARegistry is a production-level, low-latency, and highly available service registry powered by Ant Financial.">SOFARegistry<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>Main Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-boot/overview>SOFABoot</a></li><li class=item><a href=/en/projects/sofa-rpc/overview>SOFARPC</a></li><li class=item><a href=/en/projects/sofa-tracer/overview>SOFATracer</a></li><li class=item><a href=/en/projects/sofa-lookout/overview>SOFALookout</a></li><li class=item><a href=/en/projects/sofa-registry/overview>SOFARegistry</a></li></ul></div><div class=toc-list><h4 class=title>Incubating Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-mesh/overview>SOFAMesh</a></li><li class=item><a href=/en/projects/sofa-dashboard/overview>SOFADashboard</a></li></ul></div><div class=toc-list><h4 class=title>Tool Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-bolt/overview>SOFABolt</a></li><li class=item><a href=/en/projects/sofa-jraft/overview>SOFAJRaft</a></li><li class=item><a href=/en/projects/sofa-acts/overview>SOFAActs</a></li><li class=item><a href=https://www.sofastack.tech/en/projects/sofa-boot/sofa-ark-readme/>SOFAArk</a></li></ul></div><div class=toc-list><h4 class=title>Ecosystem Projects</h4><ul class=list><li class=item><a href=https://mosn.io/en>MOSN</a></li><li class=item><a href=https://occlum.io>Occlum</a></li><li class=item><a href=https://seata.io>Seata</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=Introduction>Introduction</a></div><ul class=leaf-section><li class=item><div class=link><a title=Overview href=/en/projects/sofa-registry/overview>Overview</a></div></li><li class=item><div class=link><a title=Terminology href=/en/projects/sofa-registry/terminology>Terminology</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Quick start">Quick start</a></div><ul class=leaf-section><li class=item><div class=link><a title="Server deployment" href=/en/projects/sofa-registry/server-quick-start>Server deployment</a></div></li><li class=item><div class=link><a title="Client usage" href=/en/projects/sofa-registry/client-quick-start>Client usage</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Developer guide">Developer guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="JAVA SDK" href=/en/projects/sofa-registry/java-sdk>JAVA SDK</a></div></li></ul></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Management commands</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-registry/management-api/index.md>Edit</a></div><div class=meta>Update time: 2021-01-20</div></div><article class=typo><h2 id=1-registry-meta>1. registry-meta</h2><h3 id=1-1-push-switch>1.1 Push switch</h3><p>When publishing new SOFARegistry versions, to minimize the impact on services, and avoid large amounts of push messages caused by large-scale service endpoint changes during the server restart process, we will temporarily turn off the push service at the management layer. After publishing the new SOFARegistry version, we can turn on the push service and restore the normal working conditions. Data subscription and service publication information generated for the period when the push service is turned off will be subject to global push for compensation.</p><p>Turn on the push service:</p><pre><code class=language-shell>curl &quot;http://&lt;meta_ip&gt;:9615/stopPushDataSwitch/close&quot;
</code></pre><p>Turn off the push service:</p><pre><code class=language-shell>curl &quot;http://&lt;meta_ip&gt;:9615/stopPushDataSwitch/open&quot;
</code></pre><h3 id=1-2-query-the-endpoint-list>1.2 Query the endpoint list</h3><p>View the endpoint list of the meta cluster:</p><pre><code class=language-shell>curl &quot;http://&lt;meta_ip&gt;:9615/digest/META/node/query&quot;
</code></pre><p>View the endpoint list of the data cluster:</p><pre><code class=language-shell>curl &quot;http://&lt;meta_ip&gt;:9615/digest/DATA/node/query&quot;
</code></pre><p>View the endpoint list of the session cluster:</p><pre><code class=language-shell>curl &quot;http://&lt;meta_ip&gt;:9615/digest/SESSION/node/query&quot;
</code></pre><h3 id=1-3-scale-up-down-the-meta-cluster>1.3 Scale up/down the meta cluster</h3><h4 id=1-3-1-modify-the-cluster-changepeer>1.3.1 Modify the cluster: changePeer</h4><p>You can call this operation to modify the Raft cluster list when you have scaled up/down the cluster. This allows you to correctly add nodes to or remove nodes from the cluster:</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;meta_ip&gt;:9615/manage/changePeer&quot; -d &quot;ipAddressList=&lt;ip1&gt;,&lt;ip2&gt;,&lt;ip3&gt;&quot;
</code></pre><h4 id=1-3-2-reset-the-cluster-resetpeer>1.3.2 Reset the cluster: resetPeer</h4><p>When a cluster is unavailable, for example, two of three servers are not functional, the cluster can not carry out leader election. Here, you can call this operation to reset the cluster list. For example, you can reset the cluster to a one-server cluster (with the only functional server) to resume election and restore service.</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;meta_ip&gt;:9615/manage/resetPeer&quot; -d &quot;ipAddressList=&lt;ip1&gt;,&lt;ip2&gt;,&lt;ip3&gt;&quot;
</code></pre><h2 id=2-registry-data>2. registry-data</h2><h3 id=2-1-query-data>2.1 Query data</h3><p>View the pub count:</p><pre><code class=language-shell>curl &quot;http://&lt;data_ip&gt;:9622/digest/datum/count&quot;
</code></pre><p>You can call this operation to view data published by a client based on its IP address and port number.</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;data_ip&gt;:9622/digest/connect/query&quot; -H &quot;Content-Type: application/json&quot; -d '{&quot;&lt;clientIP&gt;&quot;:&quot;&lt;client port&gt;&quot;}'
</code></pre><h2 id=3-registry-session>3. registry-session</h2><h3 id=3-1-query-data>3.1 Query data</h3><p>You can call this operation to view data published by a client based on its IP address and port number.</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;session_ip&gt;:9603/digest/pub/connect/query&quot; -H &quot;Content-Type: application/json&quot; -d '[&quot;&lt;clientIP&gt;:&lt;client port&gt;&quot;]'
</code></pre><p>You can call this operation to view data subscribed to by a client based on its IP address and port number.</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;session_ip&gt;:9603/digest/sub/connect/query&quot; -H &quot;Content-Type: application/json&quot; -d '[&quot;&lt;clientIP&gt;:&lt;client port&gt;&quot;]'
</code></pre><h3 id=3-2-clear-data-of-a-client-clientoff>3.2 Clear data of a client: clientOff</h3><p>You can call this operation to clear all sub and pub data of a client based on its IP address and port number (without disconnecting the client):</p><pre><code class=language-shell>curl -X POST &quot;http://&lt;session_ip&gt;:9603/api/clients/off&quot; -H &quot;Content-Type: application/json&quot; -d '{&quot;connectIds&quot;: [&quot;&lt;clientIP&gt;:&lt;client port&gt;&quot;]}'
</code></pre></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/sofastack/>Gitee</a>
<a class=link href=https://github.com/dromara-guides>Samples</a></div><div class=cate><h2 class=cate-title>Social Media</h2><a class=link href=https://zhuanlan.zhihu.com/sofastack>Zhihu</a>
<a class=link href=https://weibo.com/sofastack>Weibo</a>
<a class=link href=https://twitter.com/sofastack_io>Twitter</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/issues>Feedback</a>
<a class=link href=https://github.com/dromara/community>Community</a>
<a class=link href=https://github.com/dromara/wiki>Wiki</a>
<a class=link href=mailto:sofa@alipay.cloud.com>Email</a></div><div class=cate><h2 class=cate-title>Ant Financial Open Source</h2><a class=link href=https://ant.design/>Ant Design</a>
<a class=link href=https://eggjs.org/>Egg</a>
<a class=link href=https://sqlflow.org>SQLFlow</a>
<a class=link href=https://tech.antfin.com/open-source>More</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>DingTalk Group</p></div></div></div><div class=copyright><p>© 2019 - 2020 The SOFAStack Authors
<a href=http://beian.miit.gov.cn/>浙 ICP 备 16045294 号-3</a></p></div></footer></body></html>