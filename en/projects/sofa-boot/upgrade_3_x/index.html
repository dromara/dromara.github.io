<!doctype html><html><head><title>SOFABoot 3.0 upgrade · dromara(Open source organization)</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="The girl on the prairie"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=/img/favicon.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-187960192-2','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome Dromara</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-boot/upgrade_3_x/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome Dromara</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-boot/upgrade_3_x/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>SOFABoot 3.0 upgrade</h1><a class="edit-button -hidden-mobile" href=https://github.com/dromara/edit/master/content/en/projects/sofa-boot/upgrade_3_x/index.md>Edit</a></div><div class=meta>Update time: 2021-01-24</div></div><article class=typo><p>﻿## Preface
As a Spring Boot-based development framework open sourced by Ant Financial, SOFABoot provides capabilities such as Readiness Check, class isolation, and log space isolation. In addition to enhancing the Spring Boot, SOFABoot provides users with the capability to easily use SOFA middleware in Spring Boot.</p><p>We have received a lot of feedback from community users since SOFABoot was open sourced in April 2018. We are also very pleased to see many community users take an active part in building the SOFAStack open source, which greatly increases our determination to prosper SOFAStack community and ecosystem. Here, we announce the release of the SOFABoot 3.0, which is developed based on Spring Boot 2.0. SOFABoot 3.0 allows us to seamlessly integrate the extension capability of SOFABoot with official components of Spring Boot 2.x. In addition, SOFABoot 3.0 is compatible with Spring Cloud components, which allows us to easily integrate Spring Cloud components like Zuul and Config in the SOFABoot framework.</p><p>Below are the major changes of SOFABoot 3.0 compared with SOFABoot 2.x.</p><h2 id=upgrade-spring-boot-to-version-2-x>Upgrade Spring Boot to version 2.x</h2><p>Upgrade Spring Boot in SOFABoot 3.0 to version 2.0. As the Spring Boot community recently announced that the maintenance for version 1.x will end in August 2019, we will focus on SOFABoot 3.x in the future and will release SOFABoot 3.1 with Spring Boot upgraded to version 2.1 soon.</p><h2 id=spring-cloud-compatible>Spring Cloud compatible</h2><p>Some components are not compatible with SOFABoot in SOFABoot 2.x. In SOFABoot 3.x, we have run thorough compatibility tests on Spring Cloud components and fixed all problems found to ensure good compatibility between SOFABoot 3.x and Spring Cloud.</p><h1 id=webflux-framework-compatible>WebFlux framework compatible</h1><p>Spring Boot 2.x introduces the WebFlux framework. SOFABoot 3.x is compatible with WebFlux in two major aspects;
+ Health Check is compatible with the ReactiveHealthIndicator extension interface. The Readiness Check will include the implementation of the interface extension;
+ Compatible with buried points of WebFlux web requests. Point burying logs and files are compatible with common MVC requests. For detailed information, refer to <a href=http://www.sofastack.tech/sofa-tracer/docs/Usage_Of_MVC>MVC point burying request</a>.</p><h3 id=jdk-version-support>JDK version support</h3><p>SOFABoot 3.x must run on JDK 8 or higher versions and does not support JDK 6 and JDK 7.</p><h2 id=health-check>Health Check</h2><p>SOFABoot adds Readiness Check capability to Spring Boot&rsquo;s Health Check capability, to ensure that all components and operations are in a healthy state before the application goes into services. Compared with SOFABoot 2.x, SOFABoot 3.0 features great adjustments to the Health Check. It abandons some internal compatibility logic of Ant Financial and uses a friendlier coding scheme. Besides, the Health Check of SOFABoot 3.0 offers extensions in various scenarios, supports the &lsquo;ReactiveHealthIndicator&rsquo; extension interface introduced in Spring Boot 2.x, and provides more Health Check extension features.</p><h3 id=adjust-the-readiness-check-endpoint-path>Adjust the Readiness Check Endpoint path</h3><p>The Endpoint for checking the Health Check result is &lsquo;/health/readiness&rsquo; in SOFABoot 2.x. However, it has been changed to &lsquo;/actuator/readiness&rsquo; in SOFABoot 3.0.</p><h3 id=extension-interface-change>Extension interface change</h3><p>SOFABoot 3.x provides the following four ways to expand health checks:
+ HealthChecker
+ HealthIndicator (native Spring Boot)
+ ReactiveHealthIndicator (native Spring Boot)
+ ReadinessCheckCallback</p><p>Extension of these four interfaces is executed in the order of HealthChecker &gt; HealthIndicator, ReactiveHealthIndicator &gt; ReadinessCheckCallback. Extensions through the same interface are executed in the order specified in the Spring Boot standard scheme. That is to say, the extension class can implement two additional standard Order interfaces:</p><ul><li>org.springframework.core.Ordered</li><li>org.springframework.core.PriorityOrdered</li></ul><p>or use annotations</p><ul><li>org.springframework.core.annotation.Order</li></ul><p>The results of the extension implementation of these interfaces will be presented in the Health Check results.</p><h3 id=deleting-the-sofabootbeforehealthcheckevent>Deleting the SofaBootBeforeHealthCheckEvent</h3><p>SOFABoot 2.x does not support ordering the Health Check extension implementations. As a result, users are unable to expect the time when their extension will be implemented. As mentioned above, SOFABoot 3.x supports ordering component extension implementations. Extension of the unified &lsquo;HealthChecker&rsquo; interface has the highest priority, so the event is no longer necessary. In addition, the logical outcome of &lsquo;SofaBootBeforeHealthCheckEvent&rsquo; event processing is not shown in the Health Check result in SOFABoot 2.x. After &lsquo;HealthChecker&rsquo; is used, this logical processing becomes a part of the Health Check and it available for viewing.</p><h3 id=deleting-the-defaulthealthchecker-interface>Deleting the DefaultHealthChecker Interface</h3><p>The DefaultHealthChecker interface is deleted by the default method in JDK8. Users can use the HealthChecker interface as an alternative.</p><h3 id=deleting-sofabootmiddlewareafterreadinesscheckcallback-and-sofabootafterreadinesscheckcallback-interfaces>Deleting SofaBootMiddlewareAfterReadinessCheckCallback and SofaBootAfterReadinessCheckCallback Interfaces</h3><p>The two interfaces are the Health Check callbacks for two scenarios in SOFABoot 2.x. You are recommended to use SofaBootMiddlewareAfterReadinessCheckCallback for the official SOFABoot Starter and SofaBootAfterReadinessCheckCallback for service applications because the framework will first implement the extension of the former callback. There are two flaws in this design:
+ The two interfaces are the same in essence. The implicit ordering logic brings an additional learning cost for users.
+ The design only considers the order of the two interfaces and does not specify the order of implementations of the same interface.</p><p>SOFABoot 3.x introduces ReadinessCheckCallback, a unified Health Check callback interface that has been implemented by both the official Starter and service applications. The order of implementations follows the Spring Boot standard scheme. That is to say, two additional standard Order interfaces have been implemented:</p><ul><li>org.springframework.core.Ordered</li><li>org.springframework.core.PriorityOrdered</li></ul><p>or use annotations</p><ul><li>org.springframework.core.annotation.Order</li></ul><p>to control the execution order of extension implementations.</p><h2 id=viewing-version-information>Viewing Version Information</h2><h3 id=adjusting-versions-endpoint-path>Adjusting Versions Endpoint Path</h3><p>The Endpoint for viewing version information is /sofaboot/versions in SOFABoot 2. However, it has been changed to /actuator/versions in SOFABoot 3.0.</p><h2 id=conclusion>Conclusion</h2><p>The above are the detailed change records for SOFABoot 3.x. If you want an upgrade or a trial version, please contact us through <a href=https://github.com/sofastack/sofa-boot>Github</a>. We will reply promptly and provide support.</p></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/dromara>Github</a>
<a class=link href=https://gitee.com/shuaiqiyu>Gitee</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/dromara/soul/issues/new>Feedback</a>
<a class=link href=/community>Community</a>
<a class=link href=/blog>Blog</a></div><div class=cate><h2 class=cate-title>Document</h2><a class=link href=/projects/soul/overview/>Soul</a>
<a class=link href=/projects/hmily/overview/>Hmily</a>
<a class=link href=/projects/raincat/overview/>Raincat</a>
<a class=link href=/projects/myth/overview/>Myth</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>QQ Group</p></div></div></div><div class=copyright><p>Copyright ©2021
<a href=/>xiaoyu@apache.org by xiaoyu</a></p></div></footer></body></html>