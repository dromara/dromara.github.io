<!doctype html><html><head><title>Health check · SOFAStack</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=https://gw.alipayobjects.com/os/q/cms/images/jqu9346l/4ba95631-2489-4885-881f-bc7f8d787d5e_w64_h61.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-142131411-1','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome SOFA</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-boot/health-check/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome SOFA</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-boot/health-check/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title="SOFABoot is a development framework based on Spring Boot, provides capabilities such as Readiness Check, class isolation, log space isolation and asynchronous initialization of bean.">SOFABoot<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>Main Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-boot/overview>SOFABoot</a></li><li class=item><a href=/en/projects/sofa-rpc/overview>SOFARPC</a></li><li class=item><a href=/en/projects/sofa-tracer/overview>SOFATracer</a></li><li class=item><a href=/en/projects/sofa-lookout/overview>SOFALookout</a></li><li class=item><a href=/en/projects/sofa-registry/overview>SOFARegistry</a></li></ul></div><div class=toc-list><h4 class=title>Incubating Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-mesh/overview>SOFAMesh</a></li><li class=item><a href=/en/projects/sofa-dashboard/overview>SOFADashboard</a></li></ul></div><div class=toc-list><h4 class=title>Tool Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-bolt/overview>SOFABolt</a></li><li class=item><a href=/en/projects/sofa-jraft/overview>SOFAJRaft</a></li><li class=item><a href=/en/projects/sofa-acts/overview>SOFAActs</a></li><li class=item><a href=https://www.sofastack.tech/en/projects/sofa-boot/sofa-ark-readme/>SOFAArk</a></li></ul></div><div class=toc-list><h4 class=title>Ecosystem Projects</h4><ul class=list><li class=item><a href=https://mosn.io/en>MOSN</a></li><li class=item><a href=https://occlum.io>Occlum</a></li><li class=item><a href=https://seata.io>Seata</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class=link><a title="SOFABoot overview" href=/en/projects/sofa-boot/overview>SOFABoot overview</a></div></li><li class=item><div class=link><a title="Quick start guide" href=/en/projects/sofa-boot/quick-start>Quick start guide</a></div></li><li class=item><div class=link><a title="Dependency management" href=/en/projects/sofa-boot/dependency-management>Dependency management</a></div></li><li class=item><div class="link -current"><a title="Health check" href=/en/projects/sofa-boot/health-check>Health check</a></div></li><li class=item><div class=link><a title="View version" href=/en/projects/sofa-boot/view-versions>View version</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Module isolation">Module isolation</a></div><ul class=leaf-section><li class=item><div class=link><a title="Modular development" href=/en/projects/sofa-boot/modular-development>Modular development</a></div></li><li class=item><div class=link><a title="Module configuration" href=/en/projects/sofa-boot/sofaboot-module>Module configuration</a></div></li><li class=item><div class=link><a title="Publish and reference JVM services" href=/en/projects/sofa-boot/module-service>Publish and reference JVM services</a></div></li><li class=item><div class=link><a title="Module parallel startup" href=/en/projects/sofa-boot/parallel-start>Module parallel startup</a></div></li><li class=item><div class=link><a title="SOFABoot profile" href=/en/projects/sofa-boot/sofaboot-profile>SOFABoot profile</a></div></li><li class=item><div class=link><a title="SOFABoot extension point" href=/en/projects/sofa-boot/extension>SOFABoot extension point</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Class Isolation">Class Isolation</a></div><ul class=leaf-section><li class=item><div class=link><a title="Introduction to SOFAArk" href=/en/projects/sofa-boot/sofa-ark-readme>Introduction to SOFAArk</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Quick start guide">Quick start guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Package into Ark Plugin" href=/en/projects/sofa-boot/sofa-ark-ark-plugin-demo>Package into Ark Plugin</a></div></li><li class=item><div class=link><a title="Package into Ark JAR" href=/en/projects/sofa-boot/sofa-ark-ark-demo>Package into Ark JAR</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="User guide">User guide</a></div><ul class=leaf-section><li class=item><div class=link><a title=Terminologies href=/en/projects/sofa-boot/sofa-ark-terminology>Terminologies</a></div></li><li class=item><div class=link><a title="Ark JAR package" href=/en/projects/sofa-boot/sofa-ark-ark-jar>Ark JAR package</a></div></li><li class=item><div class=link><a title="Ark Plugin" href=/en/projects/sofa-boot/sofa-ark-ark-plugin>Ark Plugin</a></div></li><li class=item><div class=link><a title="Ark Biz" href=/en/projects/sofa-boot/sofa-ark-ark-biz>Ark Biz</a></div></li><li class=item><div class=link><a title="Use class isolation in SOFABoot" href=/en/projects/sofa-boot/classloader-isolation>Use class isolation in SOFABoot</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Developer guide">Developer guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Ark container startup process" href=/en/projects/sofa-boot/sofa-ark-startup>Ark container startup process</a></div></li><li class=item><div class=link><a title="Ark container plugin mechanism" href=/en/projects/sofa-boot/sofa-ark-plugin>Ark container plugin mechanism</a></div></li><li class=item><div class=link><a title="Ark container class loading mechanism" href=/en/projects/sofa-boot/sofa-ark-classloader>Ark container class loading mechanism</a></div></li></ul></li><li class=item><div class=link><a title="Release notes" href=/en/projects/sofa-boot/sofa-ark-release>Release notes</a></div></li><li class=item><div class=link><a title=Roadmap href=/en/projects/sofa-boot/sofa-ark-roadmap>Roadmap</a></div></li><li class=item><div class=link><a title=Contribution href=/en/projects/sofa-boot/sofa-ark-contribution>Contribution</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Dynamic deployment">Dynamic deployment</a></div><ul class=leaf-section><li class=item><div class=link><a title="Introduction to Jarslink" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-readme>Introduction to Jarslink</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Quick start guide">Quick start guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Create a SOFABoot application" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-app-demo>Create a SOFABoot application</a></div></li><li class=item><div class=link><a title="Use Jarslink for multi-application dynamic deployment" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-deploy-demo>Use Jarslink for multi-application dynamic deployment</a></div></li><li class=item><div class=link><a title="Communicate across applications" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-invocation-demo>Communicate across applications</a></div></li><li class=item><div class=link><a title="Integrate SOFABoot health check" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-health-demo>Integrate SOFABoot health check</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="User guide">User guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Application packaging" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-repackage>Application packaging</a></div></li><li class=item><div class=link><a title="Merged deployment" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-deploy>Merged deployment</a></div></li><li class=item><div class=link><a title="Interactive instruction" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-instruction>Interactive instruction</a></div></li><li class=item><div class=link><a title=Lifecycle href=/en/projects/sofa-boot/sofa-jarslink-jarslink-lifecycle>Lifecycle</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Developer guide">Developer guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Compile Jarslink project" href=/en/projects/sofa-boot/sofa-jarslink-compile>Compile Jarslink project</a></div></li><li class=item><div class=link><a title=Architecture href=/en/projects/sofa-boot/sofa-jarslink-structure>Architecture</a></div></li><li class=item><div class=link><a title="Basic model" href=/en/projects/sofa-boot/sofa-jarslink-model>Basic model</a></div></li><li class=item><div class=link><a title="Version release" href=/en/projects/sofa-boot/sofa-jarslink-version>Version release</a></div></li></ul></li><li class=item><div class=link><a title="Release notes" href=/en/projects/sofa-boot/sofa-jarslink-release>Release notes</a></div></li><li class=item><div class=link><a title=Roadmap href=/en/projects/sofa-boot/sofa-jarslink-roadmap>Roadmap</a></div></li><li class=item><div class=link><a title=Contribution href=/en/projects/sofa-boot/sofa-jarslink-contribution>Contribution</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Documentation for upgrade">Documentation for upgrade</a></div><ul class=leaf-section><li class=item><div class=link><a title="SOFABoot 2.5.x upgrade" href=/en/projects/sofa-boot/upgrade_2_5_x>SOFABoot 2.5.x upgrade</a></div></li><li class=item><div class=link><a title="SOFABoot 3.0 upgrade" href=/en/projects/sofa-boot/upgrade_3_x>SOFABoot 3.0 upgrade</a></div></li></ul></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Health check</h1><a class="edit-button -hidden-mobile" href=https://github.com/sofastack/sofastack.tech/edit/master/content/en/projects/sofa-boot/health-check/index.md>Edit</a></div><div class=meta>Update time: 2021-01-20</div></div><article class=typo><p>SOFABoot provides Readiness Check to enhance Spring Boot&rsquo;s Health Check. If you need to use the SOFA middleware, you are advised to use the Health Check extension of SOFABoot to launch application examples in a more elegant way.</p><h2 id=enable-health-check>Enable Health Check</h2><p>To enable the Health Check feature in SOFABoot, you only need to import the following starter:</p><pre><code class=language-xml>&lt;dependency&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;healthcheck-sofa-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><p><strong>Without the Health Check extension, users still can perform Liveness Check with native Spring Boot Actuator directly relying on the HealthIndicator interface.</strong></p><h2 id=security-alert>Security alert</h2><p>From SOFABoot 2.3.0 on, the Health Check depends on the <code>Actuator</code> component in SpringBoot 1.4.x, and the component opens a lot of <a href=https://docs.spring.io/spring-boot/docs/1.4.2.RELEASE/reference/html/production-ready-endpoints.html>EndPoint</a> such as &lsquo;/dump &rsquo; and &lsquo;/trace&rsquo;. So there may be a security risk. Refer to the <a href=https://docs.spring.io/spring-boot/docs/1.4.2.RELEASE/reference/html/production-ready-endpoints.html#_security_with_healthindicators>Security Recommendations</a> in the official document for settings.</p><p>SpringBoot 1.5.x and SpringBoot 2.x. have fixed some security issues. SOFABoot will be supported by upgrading the SpringBoot kernel.</p><h2 id=view-health-check-results>View Health Check results</h2><p>After adding the Health Check extension, you can directly browser <a href=http://localhost:8080/health/readiness>http://localhost:8080/health/readiness</a> to view the Readiness Check results. To view the Liveness Check results, access the URL of the Spring Boot Health Check results. <a href=http://localhost:8080/health>http://localhost:8080/health</a>。</p><p>In SOFABoot, you can also view Health Check results by checking the specific logs in the <code>health-check</code> directory. Generally, such logs contain the following content:</p><pre><code>2018-04-06 23:29:50,240 INFO  main                             - Readiness check result: success
</code></pre><p>At present, the SOFA middleware has controlled upstream traffic access through the Readiness Check offered by SOFABoot. But, apart from the middleware, traffic of an application may come from other sources such as the load balancer. To control such traffic, users are advised to view the Readiness Check results by PAAS and determine whether to launch corresponding nodes in the load balancer based on the results.</p><p>** Note: Versions after SOFABoot 2.x no longer indirectly introduce spring-boot-starter-web dependencies. To view Health Check results in the browser, you need to introduce Web container dependencies in the project. **</p><p>** Note: In SOFABoot 3.x, the endpoint path has been changed from health/readiness to actuator/readiness**</p><h2 id=readiness-check-extension>Readiness Check extension</h2><p>SOFABoot allows extension in every phase of the Readiness Check. Applications can be extended according to their needs. In version 2.x, the extendable points are as follows:</p><table><thead><tr><th>Callback interface</th><th>Description</th></tr></thead><tbody><tr><td>org.springframework.context.ApplicationListener</td><td>If you want to do something before the Readiness Check, you can monitor the SofaBootBeforeHealthCheckEvent event of this listener.</td></tr><tr><td>org.springframework.boot.actuate.health.HealthIndicator</td><td>If you want to add a check item to the Readiness Check in SOFABoot, you can directly extend this interface of Spring Boot.</td></tr><tr><td>com.alipay.sofa.healthcheck.startup.SofaBootAfterReadinessCheckCallback</td><td>If you want to do something after the Readiness Check, you can extend this interface of SOFABoot.</td></tr></tbody></table><p>In version 3.x, extendable points are as follows:</p><table><thead><tr><th>Callback interface</th><th>Description</th></tr></thead><tbody><tr><td>com.alipay.sofa.healthcheck.core.HealthChecker</td><td>if you want to add a check item to the Readiness Check in SOFABoot, you can extend the interface directly. Compared with the HealthIndicator interface of Spring Boot, this interface provides additional parameters, for example, check the number of retries.</td></tr><tr><td>org.springframework.boot.actuate.health.HealthIndicator</td><td>If you want to add a check item to the Readiness Check in SOFABoot, you can directly extend this interface of Spring Boot.</td></tr><tr><td>org.springframework.boot.actuate.health.ReactiveHealthIndicator</td><td>If you want to add a check item to SOFABoot&rsquo;s Readiness Check in WebFlux, you can directly extend this interface of Spring Boot.</td></tr><tr><td>com.alipay.sofa.healthcheck.startup.ReadinessCheckCallback</td><td>if you want to do something after the Readiness Check, you can extend this interface of SOFABoot.</td></tr></tbody></table><p>Note that you can set the execution order of the above four extension interfaces through Spring Boot&rsquo;s standard <code>Ordered</code> and <code>PriorityOrdered</code> interfaces and <code>@order</code> annotation.</p><h2 id=configuration-of-readiness-check>Configuration of Readiness Check</h2><p>After enabled the Health Check extension of SOFABoot to an application, you can add configuration items in Spring Boot&rsquo;s profile <code>application.properties</code> to customize the Readiness Check behavior.</p><table><thead><tr><th>Readiness Check configuration item</th><th>Instructions</th><th>Default</th><th>Supported since version</th></tr></thead><tbody><tr><td>com.alipay.sofa.healthcheck.skip.all</td><td>Whether to skip the entire Readiness Check</td><td>false</td><td>2.4.0</td></tr><tr><td>com.alipay.sofa.healthcheck.skip.component</td><td>Whether to skip the SOFA middleware Readiness Check</td><td>false</td><td>2.4.0</td></tr><tr><td>com.alipay.sofa.healthcheck.skip.indicator</td><td>Whether to skip the HealthIndicator Readiness Check</td><td>false</td><td>2.4.0</td></tr><tr><td>com.alipay.sofa.healthcheck.component.check.retry.count</td><td>The number of component Health Check retries</td><td>20</td><td>2.4.10 (the value is 0 in previous versions)</td></tr><tr><td>com.alipay.sofa.healthcheck.component.check.retry.interval</td><td>Interval between component Health Check retries</td><td>1,000 (ms)</td><td>2.4.10 (the value is 0 in previous versions)</td></tr><tr><td>com.alipay.sofa.healthcheck.module.check.retry.count</td><td>the number of sofaboot module Health Check retries</td><td>0</td><td>2.4.10</td></tr><tr><td>com.alipay.sofa.healthcheck.module.check.retry.interval</td><td>Interval between sofaboot module Health Check retries</td><td>1,000 (ms)</td><td>2.4.10 (the value is 0 in previous versions)</td></tr></tbody></table></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/sofastack>Github</a>
<a class=link href=https://gitee.com/sofastack/>Gitee</a>
<a class=link href=https://github.com/sofastack-guides>Samples</a></div><div class=cate><h2 class=cate-title>Social Media</h2><a class=link href=https://zhuanlan.zhihu.com/sofastack>Zhihu</a>
<a class=link href=https://weibo.com/sofastack>Weibo</a>
<a class=link href=https://twitter.com/sofastack_io>Twitter</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/sofastack/sofastack.tech/issues>Feedback</a>
<a class=link href=https://github.com/sofastack/community>Community</a>
<a class=link href=https://github.com/sofastack/sofastack.tech/wiki>Wiki</a>
<a class=link href=mailto:sofa@alipay.cloud.com>Email</a></div><div class=cate><h2 class=cate-title>Ant Financial Open Source</h2><a class=link href=https://ant.design/>Ant Design</a>
<a class=link href=https://eggjs.org/>Egg</a>
<a class=link href=https://sqlflow.org>SQLFlow</a>
<a class=link href=https://tech.antfin.com/open-source>More</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>DingTalk Group</p></div></div></div><div class=copyright><p>© 2019 - 2020 The SOFAStack Authors
<a href=http://beian.miit.gov.cn/>浙 ICP 备 16045294 号-3</a></p></div></footer></body></html>