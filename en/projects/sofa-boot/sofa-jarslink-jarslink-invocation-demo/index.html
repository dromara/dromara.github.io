<!doctype html><html><head><title>Communicate across applications · SOFAStack</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=https://gw.alipayobjects.com/os/q/cms/images/jqu9346l/4ba95631-2489-4885-881f-bc7f8d787d5e_w64_h61.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-142131411-1','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome SOFA</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome SOFA</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title="SOFABoot is a development framework based on Spring Boot, provides capabilities such as Readiness Check, class isolation, log space isolation and asynchronous initialization of bean.">SOFABoot<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>Main Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-boot/overview>SOFABoot</a></li><li class=item><a href=/en/projects/sofa-rpc/overview>SOFARPC</a></li><li class=item><a href=/en/projects/sofa-tracer/overview>SOFATracer</a></li><li class=item><a href=/en/projects/sofa-lookout/overview>SOFALookout</a></li><li class=item><a href=/en/projects/sofa-registry/overview>SOFARegistry</a></li></ul></div><div class=toc-list><h4 class=title>Incubating Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-mesh/overview>SOFAMesh</a></li><li class=item><a href=/en/projects/sofa-dashboard/overview>SOFADashboard</a></li></ul></div><div class=toc-list><h4 class=title>Tool Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-bolt/overview>SOFABolt</a></li><li class=item><a href=/en/projects/sofa-jraft/overview>SOFAJRaft</a></li><li class=item><a href=/en/projects/sofa-acts/overview>SOFAActs</a></li><li class=item><a href=https://www.sofastack.tech/en/projects/sofa-boot/sofa-ark-readme/>SOFAArk</a></li></ul></div><div class=toc-list><h4 class=title>Ecosystem Projects</h4><ul class=list><li class=item><a href=https://mosn.io/en>MOSN</a></li><li class=item><a href=https://occlum.io>Occlum</a></li><li class=item><a href=https://seata.io>Seata</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class=link><a title="SOFABoot overview" href=/en/projects/sofa-boot/overview>SOFABoot overview</a></div></li><li class=item><div class=link><a title="Quick start guide" href=/en/projects/sofa-boot/quick-start>Quick start guide</a></div></li><li class=item><div class=link><a title="Dependency management" href=/en/projects/sofa-boot/dependency-management>Dependency management</a></div></li><li class=item><div class=link><a title="Health check" href=/en/projects/sofa-boot/health-check>Health check</a></div></li><li class=item><div class=link><a title="View version" href=/en/projects/sofa-boot/view-versions>View version</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Module isolation">Module isolation</a></div><ul class=leaf-section><li class=item><div class=link><a title="Modular development" href=/en/projects/sofa-boot/modular-development>Modular development</a></div></li><li class=item><div class=link><a title="Module configuration" href=/en/projects/sofa-boot/sofaboot-module>Module configuration</a></div></li><li class=item><div class=link><a title="Publish and reference JVM services" href=/en/projects/sofa-boot/module-service>Publish and reference JVM services</a></div></li><li class=item><div class=link><a title="Module parallel startup" href=/en/projects/sofa-boot/parallel-start>Module parallel startup</a></div></li><li class=item><div class=link><a title="SOFABoot profile" href=/en/projects/sofa-boot/sofaboot-profile>SOFABoot profile</a></div></li><li class=item><div class=link><a title="SOFABoot extension point" href=/en/projects/sofa-boot/extension>SOFABoot extension point</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Class Isolation">Class Isolation</a></div><ul class=leaf-section><li class=item><div class=link><a title="Introduction to SOFAArk" href=/en/projects/sofa-boot/sofa-ark-readme>Introduction to SOFAArk</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Quick start guide">Quick start guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Package into Ark Plugin" href=/en/projects/sofa-boot/sofa-ark-ark-plugin-demo>Package into Ark Plugin</a></div></li><li class=item><div class=link><a title="Package into Ark JAR" href=/en/projects/sofa-boot/sofa-ark-ark-demo>Package into Ark JAR</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="User guide">User guide</a></div><ul class=leaf-section><li class=item><div class=link><a title=Terminologies href=/en/projects/sofa-boot/sofa-ark-terminology>Terminologies</a></div></li><li class=item><div class=link><a title="Ark JAR package" href=/en/projects/sofa-boot/sofa-ark-ark-jar>Ark JAR package</a></div></li><li class=item><div class=link><a title="Ark Plugin" href=/en/projects/sofa-boot/sofa-ark-ark-plugin>Ark Plugin</a></div></li><li class=item><div class=link><a title="Ark Biz" href=/en/projects/sofa-boot/sofa-ark-ark-biz>Ark Biz</a></div></li><li class=item><div class=link><a title="Use class isolation in SOFABoot" href=/en/projects/sofa-boot/classloader-isolation>Use class isolation in SOFABoot</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Developer guide">Developer guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Ark container startup process" href=/en/projects/sofa-boot/sofa-ark-startup>Ark container startup process</a></div></li><li class=item><div class=link><a title="Ark container plugin mechanism" href=/en/projects/sofa-boot/sofa-ark-plugin>Ark container plugin mechanism</a></div></li><li class=item><div class=link><a title="Ark container class loading mechanism" href=/en/projects/sofa-boot/sofa-ark-classloader>Ark container class loading mechanism</a></div></li></ul></li><li class=item><div class=link><a title="Release notes" href=/en/projects/sofa-boot/sofa-ark-release>Release notes</a></div></li><li class=item><div class=link><a title=Roadmap href=/en/projects/sofa-boot/sofa-ark-roadmap>Roadmap</a></div></li><li class=item><div class=link><a title=Contribution href=/en/projects/sofa-boot/sofa-ark-contribution>Contribution</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Dynamic deployment">Dynamic deployment</a></div><ul class=leaf-section><li class=item><div class=link><a title="Introduction to Jarslink" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-readme>Introduction to Jarslink</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Quick start guide">Quick start guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Create a SOFABoot application" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-app-demo>Create a SOFABoot application</a></div></li><li class=item><div class=link><a title="Use Jarslink for multi-application dynamic deployment" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-deploy-demo>Use Jarslink for multi-application dynamic deployment</a></div></li><li class=item><div class="link -current"><a title="Communicate across applications" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-invocation-demo>Communicate across applications</a></div></li><li class=item><div class=link><a title="Integrate SOFABoot health check" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-health-demo>Integrate SOFABoot health check</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="User guide">User guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Application packaging" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-repackage>Application packaging</a></div></li><li class=item><div class=link><a title="Merged deployment" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-deploy>Merged deployment</a></div></li><li class=item><div class=link><a title="Interactive instruction" href=/en/projects/sofa-boot/sofa-jarslink-jarslink-instruction>Interactive instruction</a></div></li><li class=item><div class=link><a title=Lifecycle href=/en/projects/sofa-boot/sofa-jarslink-jarslink-lifecycle>Lifecycle</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Developer guide">Developer guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="Compile Jarslink project" href=/en/projects/sofa-boot/sofa-jarslink-compile>Compile Jarslink project</a></div></li><li class=item><div class=link><a title=Architecture href=/en/projects/sofa-boot/sofa-jarslink-structure>Architecture</a></div></li><li class=item><div class=link><a title="Basic model" href=/en/projects/sofa-boot/sofa-jarslink-model>Basic model</a></div></li><li class=item><div class=link><a title="Version release" href=/en/projects/sofa-boot/sofa-jarslink-version>Version release</a></div></li></ul></li><li class=item><div class=link><a title="Release notes" href=/en/projects/sofa-boot/sofa-jarslink-release>Release notes</a></div></li><li class=item><div class=link><a title=Roadmap href=/en/projects/sofa-boot/sofa-jarslink-roadmap>Roadmap</a></div></li><li class=item><div class=link><a title=Contribution href=/en/projects/sofa-boot/sofa-jarslink-contribution>Contribution</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Documentation for upgrade">Documentation for upgrade</a></div><ul class=leaf-section><li class=item><div class=link><a title="SOFABoot 2.5.x upgrade" href=/en/projects/sofa-boot/upgrade_2_5_x>SOFABoot 2.5.x upgrade</a></div></li><li class=item><div class=link><a title="SOFABoot 3.0 upgrade" href=/en/projects/sofa-boot/upgrade_3_x>SOFABoot 3.0 upgrade</a></div></li></ul></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>Communicate across applications</h1><a class="edit-button -hidden-mobile" href=https://github.com/sofastack/sofastack.tech/edit/master/content/en/projects/sofa-boot/sofa-jarslink-jarslink-invocation-demo/index.md>Edit</a></div><div class=meta>Update time: 2021-01-20</div></div><article class=typo><blockquote><p><a href=https://github.com/sofastack/sofa-jarslink/tree/master/sofa-jarslink-samples/biz-jvm-invocation-sample>Project address</a></p></blockquote><h2 id=introduction>Introduction</h2><p>During merged deployment, Biz packages can communicate with each other by releasing and referencing JVM services apart from using the RPC framework. This sample project is intended to demonstrate how two Biz packages communicate by JVM services.</p><p>Within the biz-jvm-invocation-sample project, there are three sub-projects whose functions are as follows:
+ facade: A common Java module that defines the SampleJvmService interface.</p><pre><code class=language-java>package me.qlong.tech.service;

public interface SampleJvmService {
    String service();
}
</code></pre><ul><li>app-one: A SOFABoot Web application that defines a simple rest request and use the <code>@SofaReference</code> annotation to reference the SampleJvmService. When a page request is triggered, an attempt is made to call the JVM service. The key code is:</li></ul><pre><code class=language-java>package me.qlong.controller;

import com.alipay.sofa.runtime.api.annotation.SofaReference;
import me.qlong.tech.service.SampleJvmService;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {

    @SofaReference
    private SampleJvmService sampleJvmService;

    @RequestMapping(&quot;/hello&quot;)
    public String hello() {
        return sampleJvmService.service();
    }

}
</code></pre><ul><li>app-two: A non-web application in SOFABoot that uses the <code>@SofaService</code> annotation to publish the SampleJvmService.
```java
package me.qlong.tech.service.impl;</li></ul><p>import com.alipay.sofa.runtime.api.annotation.SofaService;
import me.qlong.tech.service.SampleJvmService;
import org.springframework.stereotype.Component;</p><p>@SofaService
@Component
public class AppTwoSampleService implements SampleJvmService{
public String service() {
return &ldquo;App Two&rdquo;;
}
}</p><pre><code>
## Dependency

To communicate between Biz packages through JVM services, you must add dependencies on the SOFARuntime package and the corresponding Ark Plugin as follows:

```xml
&lt;dependency&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;runtime-sofa-boot-starter&lt;/artifactId&gt;
    &lt;classifier&gt;ark-plugin&lt;/classifier&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.alipay.sofa&lt;/groupId&gt;
    &lt;artifactId&gt;runtime-sofa-boot-starter&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><p>For detailed information about publishing and referencing JVM services, see the <a href=../module-service>SOFABoot Documentation</a>. You are advised to use annotations in Jarslink2.0.</p><h2 id=demo>Demo</h2><ul><li>cd biz-jvm-invocation-sample/facade &amp;&amp; mvn clean install
Execute the mvn clean install command in the facade root directory, and install the facade package in the local Maven repository so that you can add a facade dependency in app-one and app-two:</li></ul><pre><code class=language-xml>&lt;!--service facade--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;me.qlong.tech&lt;/groupId&gt;
    &lt;artifactId&gt;facade&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><ul><li><p>cd biz-jvm-invocation-sample/app-one &amp;&amp; mvn clean package
Execute the mvn clean package command in the app-one root directory and package the application into Ark and Biz packages. The files will be exported to the biz-jvm-invocation-sample/app-one/target directory.</p></li><li><p>cd biz-jvm-invocation-sample/app-two &amp;&amp; mvn clean package
Execute the mvn clean package command in the app-two root directory and package the application into Ark and Biz packages. The files will be exported to the biz-jvm-invocation-sample/app-two/target directory.</p></li><li><p>Use java -jar to start the Ark package for app-one.</p></li><li><p>After the Ark package has started, visit <a href=http://localhost:8080/hello>http://localhost:8080/hello</a> in the browser. The following error message is displayed on the page warning that the JVM service for me.qlong.tech.service.SampleJvmService cannot be found:</p></li></ul><pre><code class=language-text>There was an unexpected error (type=Internal Server Error, status=500).
JVM Reference[interface me.qlong.tech.service.SampleJvmService#] cant not find the corresponding JVM service. Please check if there is a SOFA deployment publish the corresponding JVM service. If this exception occurred when the application starts up, please add Require-Module to SOFA deployment's MANIFEST.MF to indicate the startup dependency of SOFA modules.
</code></pre><ul><li>The error message appears because handling the /hello request triggers app-one to call the me.qlong.tech.service.SampleJvmService and no other Biz packages are publishing the service at this moment.</li><li>Run telnet localhost 1234 to access the Jarslink2.0 command interface and execute the install -b command to install the Biz package that starts app-two.</li><li>Visit <a href=http://localhost:8080/hello>http://localhost:8080/hello</a> again in the browser and the page displays &ldquo;App Two.” This indicates that the request successfully triggered app-one to call the me.qlong.tech.service.SampleJvmService published by app-two.</li></ul></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/sofastack>Github</a>
<a class=link href=https://gitee.com/sofastack/>Gitee</a>
<a class=link href=https://github.com/sofastack-guides>Samples</a></div><div class=cate><h2 class=cate-title>Social Media</h2><a class=link href=https://zhuanlan.zhihu.com/sofastack>Zhihu</a>
<a class=link href=https://weibo.com/sofastack>Weibo</a>
<a class=link href=https://twitter.com/sofastack_io>Twitter</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/sofastack/sofastack.tech/issues>Feedback</a>
<a class=link href=https://github.com/sofastack/community>Community</a>
<a class=link href=https://github.com/sofastack/sofastack.tech/wiki>Wiki</a>
<a class=link href=mailto:sofa@alipay.cloud.com>Email</a></div><div class=cate><h2 class=cate-title>Ant Financial Open Source</h2><a class=link href=https://ant.design/>Ant Design</a>
<a class=link href=https://eggjs.org/>Egg</a>
<a class=link href=https://sqlflow.org>SQLFlow</a>
<a class=link href=https://tech.antfin.com/open-source>More</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>DingTalk Group</p></div></div></div><div class=copyright><p>© 2019 - 2020 The SOFAStack Authors
<a href=http://beian.miit.gov.cn/>浙 ICP 备 16045294 号-3</a></p></div></footer></body></html>