<!doctype html><html><head><title>SOFAJRaft overview · SOFAStack</title><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="SOFAStack is a Scalable Open Financial Architecture for building cloud native applications"><meta name=generator content="Hugo 0.55.5"><link rel="shortcut icon" href=https://gw.alipayobjects.com/os/q/cms/images/jqu9346l/4ba95631-2489-4885-881f-bc7f8d787d5e_w64_h61.png type=image/png><link href=https://unpkg.com/purecss@1.0.0/build/base-min.css rel=stylesheet><link href=/css/main.css rel=stylesheet><link href=/css/zoom-image.css rel=stylesheet><script src=/js/iconfont.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad();</script><script>window.SITE_LANGUAGE="en"</script><script src=/js/app.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','UA-142131411-1','auto');ga('send','pageview');}</script></head><body><header class=ss-header><nav class=navbar role=navigation aria-label="main navigation"><div class=navbar-brand><a class=logo-link href=/en/><img class=logo src=/img/logo.png></a><div class=-show-mobile><a id=mobile-menu-icon><svg class="icon" aria-hidden="true"><use xlink:href="#icon-menu"/></svg></a><nav id=mobile-menu><div id=js-menu-search-mobile class=navbar-search-mobile><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div><a href=/en/projects/><span>Projects</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/guides/><span>Guides</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/blog/><span>Blog</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/en/activities/><span>Activity</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/awesome/><span>Awesome SOFA</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-ARROW"/></svg></a>
<a href=/projects/sofa-jraft/overview/><span>中文</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-transfer"/></svg></a></nav></div></div><div class="navbar-menu -hidden-mobile"><div class=navbar-start><a class=navbar-item href=/en/projects/>Projects</a>
<a class=navbar-item href=/en/guides/>Guides</a>
<a class=navbar-item href=/en/blog/>Blog</a>
<a class=navbar-item href=/en/activities/>Activity</a>
<a class=navbar-item href=/awesome/>Awesome SOFA</a></div><div class=navbar-end><div class=navbar-item><div id=js-menu-search class=navbar-search><input class=input placeholder=Search><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search"/></svg></div></div><div class=navbar-item><a class=translation href=/projects/sofa-jraft/overview/>中</a></div></div></div></nav></header><div class=ss-layout-container><aside class="ss-layout-aside -left ss-card -soft-hidden"><div id=js-drawer class=ss-toc><div id=js-drawer-handle class=drawer-handle><svg class="icon icon-menu" aria-hidden="true"><use xlink:href="#icon-menu"/></svg><svg class="icon icon-close" aria-hidden="true"><use xlink:href="#icon-close"/></svg></div><div class=drawer-body><div class=header title="SOFAJRaft is a production-level high-performance Java implementation based on the RAFT consensus algorithm. It supports MULTI-RAFT-GROUP and is suitable for high-load and low-latency scenarios.">SOFAJRaft<div class="ss-toc-list-card -hidden-mobile"><svg class="icon -hidden-mobile" aria-hidden="true"><use xlink:href="#icon-menu1"/></svg><div class=ss-tooltip><div class=toc-list><h4 class=title>Main Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-boot/overview>SOFABoot</a></li><li class=item><a href=/en/projects/sofa-rpc/overview>SOFARPC</a></li><li class=item><a href=/en/projects/sofa-tracer/overview>SOFATracer</a></li><li class=item><a href=/en/projects/sofa-lookout/overview>SOFALookout</a></li><li class=item><a href=/en/projects/sofa-registry/overview>SOFARegistry</a></li></ul></div><div class=toc-list><h4 class=title>Incubating Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-mesh/overview>SOFAMesh</a></li><li class=item><a href=/en/projects/sofa-dashboard/overview>SOFADashboard</a></li></ul></div><div class=toc-list><h4 class=title>Tool Projects</h4><ul class=list><li class=item><a href=/en/projects/sofa-bolt/overview>SOFABolt</a></li><li class=item><a href=/en/projects/sofa-jraft/overview>SOFAJRaft</a></li><li class=item><a href=/en/projects/sofa-acts/overview>SOFAActs</a></li><li class=item><a href=https://www.sofastack.tech/en/projects/sofa-boot/sofa-ark-readme/>SOFAArk</a></li></ul></div><div class=toc-list><h4 class=title>Ecosystem Projects</h4><ul class=list><li class=item><a href=https://mosn.io/en>MOSN</a></li><li class=item><a href=https://occlum.io>Occlum</a></li><li class=item><a href=https://seata.io>Seata</a></li></ul></div></div></div></div><div class=body><ul class=leaf-section><li class=item><div class="link -current"><a title="SOFAJRaft overview" href=/en/projects/sofa-jraft/overview>SOFAJRaft overview</a></div></li><li class=item><div class=link><a title="Engine architecture" href=/en/projects/sofa-jraft/engine-architecture>Engine architecture</a></div></li><li class=item><div class=link><a title="Jepsen tests" href=/en/projects/sofa-jraft/jepson-test>Jepsen tests</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="User guide">User guide</a></div><ul class=leaf-section><li class=item><div class=link><a title="JRaft user guide" href=/en/projects/sofa-jraft/jraft-user-guide>JRaft user guide</a></div></li><li class=item><div class=link><a title="JRaft RheaKV user guide" href=/en/projects/sofa-jraft/jraft-rheakv-user-guide>JRaft RheaKV user guide</a></div></li><li class=item><div class=link><a title="Counter example" href=/en/projects/sofa-jraft/counter-example>Counter example</a></div></li></ul></li><li class=item><div class=link><a title="Maven dependency description'" href=/en/projects/sofa-jraft/maven-dependency>Maven dependency description&#39;</a></div></li><li class=item><div class=link><a title="Release notes" href=/en/projects/sofa-jraft/release-log>Release notes</a></div></li><li class=item><div class=link><a title="Benchmark data" href=/en/projects/sofa-jraft/benchmark-performance>Benchmark data</a></div></li><li class=item><div class=link><a title="User stories" href=/en/projects/sofa-jraft/user-stories>User stories</a></div></li><li class=item><div class=link><a title=Roadmap href=/en/projects/sofa-jraft/road-map>Roadmap</a></div></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title="Related articles">Related articles</a></div><ul class=leaf-section><li class=item><div class=link><a title="Introduction to Raft algorithms" href=/en/projects/sofa-jraft/raft-introduction>Introduction to Raft algorithms</a></div></li><li class=item><div class=link><a title="Distributed consensus - Raft and JRaft" href=/en/projects/sofa-jraft/consistency-raft-jraft>Distributed consensus - Raft and JRaft</a></div></li></ul></li><li class=item><div class=link><svg class="icon arrow" aria-hidden="true"><use xlink:href="#icon-arrow"/></svg><a title=Other>Other</a></div><ul class=leaf-section><li class=item><div class=link><a title="How to contribute to SOFAJRaft" href=/en/projects/sofa-jraft/how-to-contribute-code-to-sofajraft>How to contribute to SOFAJRaft</a></div></li></ul></li></ul></div></div></div></aside><main class="ss-layout-main -card"><div class=ss-meta><div class=container><h1 class=title>SOFAJRaft overview</h1><a class="edit-button -hidden-mobile" href=https://github.com/sofastack/sofastack.tech/edit/master/content/en/projects/sofa-jraft/overview/index.md>Edit</a></div><div class=meta>Update time: 2021-01-20</div></div><article class=typo><p>This topic is a part of the <a href=https://github.com/brpc/braft>Braft</a> document. To read the Braft document, click <a href=https://github.com/brpc/braft/blob/master/docs/cn/overview.md>here</a>. The Raft algorithm and its application are comprehensively described in the Braft document. As JRaft is designed on the basis of Braft,
we strongly recommend that you read the Braft document first to understand the basic principles and application of the Raft algorithm.</p><h2 id=distributed-consensus>Distributed consensus</h2><p>Distributed consensus is a very fundamental problem in a distributed system. Simply put, it is about how to reach a consensus on a specific value among multiple servers, and ensure that the decision is not overthrown regardless of what failures may occur on these servers.
Assume that, all processes of a distributed system needs to determine a value V. If the system has the following properties, we consider it solves the problem of distributed consensus:</p><ul><li>Termination: All normal processes will determine the specific value of V, and there is no process that keeps running in a loop.</li><li>Validity: A value V&rsquo; determined by normal processes must have been proposed by one of them. For example, a random number generator does not have this property.</li><li>Agreement: All normal processes choose the same value.</li></ul><h2 id=consensus-state-machine>Consensus state machine</h2><p>Assume we have an infinitely incrementing sequence (system) a[1, 2, 3…]. If for any integer i, the value of a[i] meets the distributed consensus requirement, the system meets the requirement of a consensus state machine.
Basically, all systems are subject to continuous operations, and reaching consensus on a single value is definitely not enough. To make sure all replicas of a real-life system are consistent, we usually convert the operations into entries of a <a href=https://en.wikipedia.org/wiki/Write-ahead_logging>write-ahead-log</a>(WAL). Then, we make sure all replicas of the system reach a consensus on the WAL entries, so that each process will perform operations corresponding to the WAL entries in order. As a result, the replicas are in consistent states.</p><p><img src=raft.png alt=Raft></p><h2 id=raft>RAFT</h2><p>RAFT is a new and easy-to-understand distributed consensus replication protocol proposed by Diego Ongaro and John Ousterhout of Stanford University as a central coordination component of the <a href=https://ramcloud.atlassian.net/wiki/display/RAM/RAMCloud>RAMCloud</a>project. Raft is a leader-based multi-Paxos variant that provides a more complete and straightforward protocol description than existing protocols such as Paxos, Zab, and Viewstamped Replication. It also provides a clear description for adding and deleting nodes.
In Raft, replicated state machines are the most important and fundamental to distributed systems. Raft allows commands to be replicated and executed in order, and ensures that the states of nodes remain consistent when their initial states are the same. A system is fully functional (available) as long as a majority of nodes function properly. It allows non-Byzantine conditions, including network delays, packet loss, and reordering, but does not allow tampering with any messages.</p><p><img src=multi_raft.png alt=multi_raft></p><p>Raft can solve the distributed consensus and partitioning problems, but cannot solve the availability problem. Raft covers some common features of distributed systems:</p><ul><li>Leader election</li><li>Log replication</li><li>Membership change</li><li>Log compaction</li></ul><h1 id=application-of-raft>Application of Raft</h1><p>We can use the Raft consensus state machine to replicate, repair, and manage nodes, which significantly streamlines the design and implementation of distributed systems, and allows developers to focus only on the service logic by implementing services as the corresponding state machines. We can build many distributed applications based on this framework:</p><ul><li>Distributed lock services such as ZooKeeper.</li><li>Distributed storage systems, such as distributed message queues, distributed block systems, distributed file systems, and distributed table systems.</li><li>It can also be used for highly reliable meta information management, for example, the high availability mechanism of various management modules.</li></ul><h2 id=jraft>JRaft</h2><p>JRaft is a <a href=https://raft.github.io/>Raft</a> implementation that is completely based on Java, and it rewrites all features of Baidu&rsquo;s <a href=https://github.com/brpc/braft>Braft</a> in Java, including:</p><ol><li>Leader election.</li><li>Replication and recovery.</li><li>Snapshot and log compaction.</li><li>Membership management.</li><li>Fully concurrent replication.</li><li>Fault tolerance.</li><li>Asymmetric network partition tolerance.</li><li>Workaround when quorate peers are dead.</li><li>Replication pipeline optimistic</li><li>Linearizable read, ReadIndex/LeaseRead.</li></ol><h2 id=contact-us>Contact us</h2><p>Welcome to join our DingTalk chat group: 23127468.</p></article></main></div><footer class=ss-footer><div class=container><div class=links><div class=cate><h2 class=cate-title>Resources</h2><a class=link href=https://github.com/sofastack>Github</a>
<a class=link href=https://gitee.com/sofastack/>Gitee</a>
<a class=link href=https://github.com/sofastack-guides>Samples</a></div><div class=cate><h2 class=cate-title>Social Media</h2><a class=link href=https://zhuanlan.zhihu.com/sofastack>Zhihu</a>
<a class=link href=https://weibo.com/sofastack>Weibo</a>
<a class=link href=https://twitter.com/sofastack_io>Twitter</a></div><div class=cate><h2 class=cate-title>Get Involved</h2><a class=link href=https://github.com/sofastack/sofastack.tech/issues>Feedback</a>
<a class=link href=https://github.com/sofastack/community>Community</a>
<a class=link href=https://github.com/sofastack/sofastack.tech/wiki>Wiki</a>
<a class=link href=mailto:sofa@alipay.cloud.com>Email</a></div><div class=cate><h2 class=cate-title>Ant Financial Open Source</h2><a class=link href=https://ant.design/>Ant Design</a>
<a class=link href=https://eggjs.org/>Egg</a>
<a class=link href=https://sqlflow.org>SQLFlow</a>
<a class=link href=https://tech.antfin.com/open-source>More</a></div></div><div class=qrcode><div><img class=qrcode-img src=/img/qrcode/qrcode_1.png><p class=qrcode-desc>Wechat Official Account</p></div><div><img class=qrcode-img src=/img/qrcode/qrcode_2.png><p class=qrcode-desc>DingTalk Group</p></div></div></div><div class=copyright><p>© 2019 - 2020 The SOFAStack Authors
<a href=http://beian.miit.gov.cn/>浙 ICP 备 16045294 号-3</a></p></div></footer></body></html>